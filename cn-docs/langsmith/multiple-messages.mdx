---
title: 测试多轮对话
sidebarTitle: Test multi-turn conversations
---
本操作指南将引导您了解设置多轮对话测试环境的多种方法，让您能够针对较长的消息序列测试不同的工具配置和系统提示。

![多轮对话示意图](/langsmith/images/multiturn-diagram.png)

## 从现有运行记录开始

首先，请确保您已正确[追踪](/langsmith/observability)多轮对话，然后导航至您的追踪项目。进入追踪项目后，只需打开运行记录，选择 LLM 调用，并按以下方式在测试环境中打开：

![从运行记录创建多轮对话](/langsmith/images/multiturn-from-run.gif)

随后您可以编辑系统提示、调整工具和/或输出模式，并观察多轮对话的输出如何变化。

## 从数据集开始

开始之前，请确保您已[设置好数据集](/langsmith/manage-datasets-in-application)。由于您需要评估多轮对话，请确保输入数据中包含一个包含消息列表的键。

创建数据集后，前往测试环境并[加载您的数据集](/langsmith/manage-datasets-in-application#from-the-prompt-playground)进行评估。

接着，在提示中添加消息列表变量，确保其命名与输入中包含消息列表的键名一致：

![从数据集创建多轮对话](/langsmith/images/multiturn-from-dataset.gif)

运行提示时，每个示例中的消息将作为列表替换“消息列表”变量。

## 手动创建

手动创建多轮对话有两种方式。第一种是直接在提示中追加消息：

![手动创建多轮对话](/langsmith/images/multiturn-manual.gif)

这种方式适合快速迭代，但由于多轮对话是硬编码的，灵活性较差。如果您希望提示能适用于任何多轮对话，可以添加“消息列表”变量并将多轮对话内容置于其中：

![手动创建消息列表](/langsmith/images/multiturn-manual-list.gif)

这样您只需调整系统提示或工具，同时允许任何多轮对话替换 `Messages List` 变量，从而在不同运行中复用此提示。

## 后续步骤

现在您已了解如何为多轮交互设置测试环境，您可以手动检查并评估输出结果，也可以[添加评估器](/langsmith/code-evaluator)对结果进行分类。

您还可以阅读[这些操作指南](/langsmith/create-a-prompt)，进一步了解如何使用测试环境进行评估。
