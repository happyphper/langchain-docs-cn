---
title: 嵌入模型
---
## 概述

<Note>
本概述涵盖**基于文本的嵌入模型**。LangChain 目前暂不支持多模态嵌入。

请参阅 [主流嵌入模型](#top-integrations)。
</Note>

嵌入模型将原始文本（例如句子、段落或推文）转换为固定长度的数字向量，该向量捕获了文本的**语义含义**。这些向量使得机器能够基于含义而非精确的词语来比较和搜索文本。

在实践中，这意味着具有相似思想的文本在向量空间中被放置在相近的位置。例如，嵌入不仅可以匹配短语 *"机器学习"*，还可以检索出讨论相关概念的文档，即使这些文档使用了不同的措辞。

### 工作原理

1.  **向量化** — 模型将每个输入字符串编码为一个高维向量。
2.  **相似度评分** — 使用数学度量来比较向量，以衡量底层文本的关联程度。

### 相似度度量

通常使用以下几种度量方法来比较嵌入：

*   **余弦相似度** — 测量两个向量之间的夹角。
*   **欧几里得距离** — 测量点之间的直线距离。
*   **点积** — 测量一个向量在另一个向量上的投影大小。

以下是一个计算两个向量之间余弦相似度的示例：

```python
import numpy as np

def cosine_similarity(vec1, vec2):
    dot = np.dot(vec1, vec2)
    return dot / (np.linalg.norm(vec1) * np.linalg.norm(vec2))

similarity = cosine_similarity(query_embedding, document_embedding)
print("Cosine Similarity:", similarity)
```

## 接口

LangChain 通过 @[Embeddings] 接口为文本嵌入模型（例如 OpenAI、Cohere、Hugging Face）提供了标准接口。

主要提供两个方法：

*   `embed_documents(texts: List[str]) → List[List[float]]`: 嵌入一个文档列表。
*   `embed_query(text: str) → List[float]`: 嵌入单个查询。

<Note>
该接口允许查询和文档使用不同的策略进行嵌入，尽管在实践中大多数提供商以相同的方式处理它们。
</Note>

## 主流集成

| 模型                                                               | 包                                                                                                                                                            |
|------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [`OpenAIEmbeddings`](/oss/integrations/text_embedding/openai)                      | [`langchain-openai`](https://python.langchain.com/api_reference/openai/chat_models/langchain_openai.chat_models.base.ChatOpenAI.html)                              |
| [`AzureOpenAIEmbeddings`](/oss/integrations/text_embedding/azure_openai)       | [`langchain-openai`](https://python.langchain.com/api_reference/openai/embeddings/langchain_openai.embeddings.azure.AzureOpenAIEmbeddings.html)                    |
| [`GoogleGenerativeAIEmbeddings`](/oss/integrations/text_embedding/google_generative_ai) | [`langchain-google-genai`](https://python.langchain.com/api_reference/google_genai/embeddings/langchain_google_genai.embeddings.GoogleGenerativeAIEmbeddings.html) |
| [`OllamaEmbeddings`](/oss/integrations/text_embedding/ollama)                      | [`langchain-ollama`](https://python.langchain.com/api_reference/ollama/embeddings/langchain_ollama.embeddings.OllamaEmbeddings.html)                               |
| [`TogetherEmbeddings`](/oss/integrations/text_embedding/together)                  | [`langchain-together`](https://python.langchain.com/api_reference/together/embeddings/langchain_together.embeddings.TogetherEmbeddings.html)                       |
| [`FireworksEmbeddings`](/oss/integrations/text_embedding/fireworks)                | [`langchain-fireworks`](https://python.langchain.com/api_reference/fireworks/embeddings/langchain_fireworks.embeddings.FireworksEmbeddings.html)                   |
| [`MistralAIEmbeddings`](/oss/integrations/text_embedding/mistralai)                | [`langchain-mistralai`](https://python.langchain.com/api_reference/mistralai/embeddings/langchain_mistralai.embeddings.MistralAIEmbeddings.html)                   |
| [`CohereEmbeddings`](/oss/integrations/text_embedding/cohere)                      | [`langchain-cohere`](https://python.langchain.com/api_reference/community/llms/langchain_community.llms.cohere.Cohere.html)                                        |
| [`NomicEmbeddings`](/oss/integrations/text_embedding/nomic)                        | [`langchain-nomic`](https://python.langchain.com/api_reference/nomic/embeddings/langchain_nomic.embeddings.NomicEmbeddings.html)                                   |
| [`FakeEmbeddings`](/oss/integrations/text_embedding/fake)                          | [`langchain-core`](https://python.langchain.com/api_reference/core/embeddings/langchain_core.embeddings.fake.FakeEmbeddings.html)                                  |
| [`DatabricksEmbeddings`](/oss/integrations/text_embedding/databricks)              | [`databricks-langchain`](https://api-docs.databricks.com/python/databricks-ai-bridge/latest/databricks_langchain.html#databricks_langchain.DatabricksEmbeddings)   |
| [`WatsonxEmbeddings`](/oss/integrations/text_embedding/ibm_watsonx)                    | [`langchain-ibm`](https://python.langchain.com/api_reference/ibm/embeddings/langchain_ibm.embeddings.WatsonxEmbeddings.html)                                       |
| [`NVIDIAEmbeddings`](/oss/integrations/text_embedding/nvidia_ai_endpoints)         | [`langchain-nvidia`](https://python.langchain.com/api_reference/nvidia_ai_endpoints/embeddings/langchain_nvidia_ai_endpoints.embeddings.NVIDIAEmbeddings.html)     |
| [`AimlapiEmbeddings`](/oss/integrations/text_embedding/aimlapi)                  | [`langchain-aimlapi`](https://python.langchain.com/api_reference/aimlapi/embeddings/langchain_aimlapi.embeddings.AimlapiEmbeddings.html)                           |


## 缓存

嵌入可以被存储或临时缓存，以避免重复计算。

可以使用 `CacheBackedEmbeddings` 来缓存嵌入。这个包装器将嵌入存储在键值存储中，其中文本被哈希处理，哈希值用作缓存中的键。

初始化 `CacheBackedEmbeddings` 的主要支持方式是 `from_bytes_store`。它接受以下参数：

-   **`underlying_embedder`**: 用于嵌入的基础嵌入器。
-   **`document_embedding_cache`**: 用于缓存文档嵌入的任何 [`ByteStore`](/oss/integrations/stores/)。
-   **`batch_size`**: (可选，默认为 `None`) 在存储更新之间要嵌入的文档数量。
-   **`namespace`**: (可选，默认为 `""`) 用于文档缓存的命名空间。有助于避免冲突（例如，将其设置为嵌入模型名称）。
-   **`query_embedding_cache`**: (可选，默认为 `None`) 用于缓存查询嵌入的 [`ByteStore`](/oss/integrations/stores/)，或者设置为 `True` 以复用与 `document_embedding_cache` 相同的存储。

<Important>
-   在使用不同的嵌入模型时，务必设置 `namespace` 参数以避免冲突。
-   `CacheBackedEmbeddings` 默认不缓存查询嵌入。要启用此功能，请指定 `query_embedding_cache`。
</Important>

```python
import time
from langchain_classic.embeddings import CacheBackedEmbeddings  # [!code highlight]
from langchain_classic.storage import LocalFileStore # [!code highlight]
from langchain_core.vectorstores import InMemoryVectorStore

# 创建你的基础嵌入模型
underlying_embeddings = ... # 例如，OpenAIEmbeddings(), HuggingFaceEmbeddings() 等。

# 存储将嵌入持久化到本地文件系统
# 这不适用于生产环境，但对本地开发有用
store = LocalFileStore("./cache/") # [!code highlight]

cached_embedder = CacheBackedEmbeddings.from_bytes_store(
    underlying_embeddings,
    store,
    namespace=underlying_embeddings.model
)

# 示例：缓存查询嵌入
tic = time.time()
print(cached_embedder.embed_query("Hello, world!"))
print(f"First call took: {time.time() - tic:.2f} seconds")

# 后续调用使用缓存
tic = time.time()
print(cached_embedder.embed_query("Hello, world!"))
print(f"Second call took: {time.time() - tic:.2f} seconds")
```

在生产环境中，通常会使用更健壮的持久化存储，例如数据库或云存储。请参阅 [存储集成](/oss/integrations/stores/) 了解选项。

## 所有嵌入模型

<Columns cols={3}>
<Card title="Aleph Alpha" icon="link" href="/oss/integrations/text_embedding/aleph_alpha" arrow="true" cta="查看指南" />
<Card title="Anyscale" icon="link" href="/oss/integrations/text_embedding/anyscale" arrow="true" cta="查看指南" />
<Card title="Ascend" icon="link" href="/oss/integrations/text_embedding/ascend" arrow="true" cta="查看指南" />
<Card title="AI/ML API" icon="link" href="/oss/integrations/text_embedding/aimlapi" arrow="true" cta="查看指南" />
<Card title="AwaDB" icon="link" href="/oss/integrations/text_embedding/awadb" arrow="true" cta="查看指南" />
<Card title="AzureOpenAI" icon="link" href="/oss/integrations/text_embedding/azure_openai" arrow="true" cta="查看指南" />
<Card title="Baichuan Text Embeddings" icon="link" href="/oss/integrations/text_embedding/baichuan" arrow="true" cta="查看指南" />
<Card title="Baidu Qianfan" icon="link" href="/oss/integrations/text_embedding/baidu_qianfan_endpoint" arrow="true" cta="查看指南" />
<Card title="Baseten" icon="link" href="/oss/integrations/text_embedding/baseten" arrow="true" cta="查看指南" />
<Card title="Bedrock" icon="link" href="/oss/integrations/text_embedding/bedrock" arrow="true" cta="查看指南" />
<Card title="BGE on Hugging Face" icon="link" href="/oss/integrations/text_embedding/bge_huggingface" arrow="true" cta="查看指南" />
<Card title="Bookend AI" icon="link" href="/oss/integrations/text_embedding/bookend" arrow="true" cta="查看指南" />
<Card title="Clarifai" icon="link" href="/oss/integrations/text_embedding/clarifai" arrow="true" cta="查看指南" />
<Card title="Cloudflare Workers AI" icon="link" href="/oss/integrations/text_embedding/cloudflare_workersai" arrow="true" cta="查看指南" />
<Card title="Clova Embeddings" icon="link" href="/oss/integrations/text_embedding/clova" arrow="true" cta="查看指南" />
<Card title="Cohere" icon="link" href="/oss/integrations/text_embedding/cohere" arrow="true" cta="查看指南" />
<Card title="DashScope" icon="link" href="/oss/integrations/text_embedding/dashscope" arrow="true" cta="查看指南" />
<Card title="Databricks" icon="link" href="/oss/integrations/text_embedding/databricks" arrow="true" cta="查看指南" />
<Card title="DeepInfra" icon="link" href="/oss/integrations/text_embedding/deepinfra" arrow="true" cta="查看指南" />
<Card title="EDEN AI" icon="link" href="/oss/integrations/text_embedding/edenai" arrow="true" cta="查看指南" />
<Card title="Elasticsearch" icon="link" href="/oss/integrations/text_embedding/elasticsearch" arrow="true" cta="查看指南" />
<Card title="Embaas" icon="link" href="/oss/integrations/text_embedding/embaas" arrow="true" cta="查看指南" />
<Card title="Fake Embeddings" icon="link" href="/oss/integrations/text_embedding/fake" arrow="true" cta="查看指南" />
<Card title="FastEmbed by Qdrant" icon="link" href="/oss/integrations/text_embedding/fastembed" arrow="true" cta="查看指南" />
<Card title="Fireworks" icon="link" href="/oss/integrations/text_embedding/fireworks" arrow="true" cta="查看指南" />
<Card title="Google Gemini" icon="link" href="/oss/integrations/text_embedding/google_generative_ai" arrow="true" cta="查看指南" />
<Card title="Google Vertex AI" icon="link" href="/oss/integrations/text_embedding/google_vertex_ai" arrow="true" cta="查看指南" />
<Card title="GPT4All" icon="link" href="/oss/integrations/text_embedding/gpt4all" arrow="true" cta="查看指南" />
<Card title="Gradient" icon="link" href="/oss/integrations/text_embedding/gradient" arrow="true" cta="查看指南" />
<Card title="GreenNode" icon="link" href="/oss/integrations/text_embedding/greennode" arrow="true" cta="查看指南" />
<Card title="Hugging Face" icon="link" href="/oss/integrations/text_embedding/huggingfacehub" arrow="true" cta="查看指南" />
<Card title="IBM watsonx.ai" icon="link" href="/oss/integrations/text_embedding/ibm_watsonx" arrow="true" cta="查看指南" />
<Card title="Infinity" icon="link" href="/oss/integrations/text_embedding/infinity" arrow="true" cta="查看指南" />
<Card title="Instruct Embeddings" icon="link" href="/oss/integrations/text_embedding/instruct_embeddings" arrow="true" cta="查看指南" />
<Card title="IPEX-LLM CPU" icon="link" href="/oss/integrations/text_embedding/ipex_llm" arrow="true" cta="查看指南" />
<Card title="IPEX-LLM GPU" icon="link" href="/oss/integrations/text_embedding/ipex_llm_gpu" arrow="true" cta="查看指南" />
<Card title="Isaacus" icon="link" href="/oss/integrations/text_embedding/isaacus" arrow="true" cta="查看指南" />
<Card title="Intel Extension for Transformers" icon="link" href="/oss/integrations/text_embedding/itrex" arrow="true" cta="查看指南" />
<Card title="Jina" icon="link" href="/oss/integrations/text_embedding/jina" arrow="true" cta="查看指南" />
<Card title="John Snow Labs" icon="link" href="/oss/integrations/text_embedding/johnsnowlabs_embedding" arrow="true" cta="查看指南" />
<Card title="LASER" icon="link" href="/oss/integrations/text_embedding/laser" arrow="true" cta="查看指南" />
<Card title="Lindorm" icon="link" href="/oss/integrations/text_embedding/lindorm" arrow="true" cta="查看指南" />
<Card title="Llama.cpp" icon="link" href="/oss/integrations/text_embedding/llamacpp" arrow="true" cta="查看指南" />
<Card title="LLMRails" icon="link" href="/oss/integrations/text_embedding/llm_rails" arrow="true" cta="查看指南" />
<Card title="LocalAI" icon="link" href="/oss/integrations/text_embedding/localai" arrow="true" cta="查看指南" />
<Card title="MiniMax" icon="link" href="/oss/integrations/text_embedding/minimax" arrow="true" cta="查看指南" />
<Card title="MistralAI" icon="link" href="/oss/integrations/text_embedding/mistralai" arrow="true" cta="查看指南" />
<Card title="Model2Vec" icon="link" href="/oss/integrations/text_embedding/model2vec" arrow="true" cta="查看指南" />
<Card title="ModelScope" icon="link" href="/oss/integrations/text_embedding/modelscope_embedding" arrow="true" cta="查看指南" />
<Card title="MosaicML" icon="link" href="/oss/integrations/text_embedding/mosaicml" arrow="true" cta="查看指南" />
<Card title="Naver" icon="link" href="/oss/integrations/text_embedding/naver" arrow="true" cta="查看指南" />
<Card title="Nebius" icon="link" href="/oss/integrations/text_embedding/nebius" arrow="true" cta="查看指南" />
<Card title="Netmind" icon="link" href="/oss/integrations/text_embedding/netmind" arrow="true" cta="查看指南" />
<Card title="NLP Cloud" icon="link" href="/oss/integrations/text_embedding/nlp_cloud" arrow="true" cta="查看指南" />
<Card title="Nomic" icon="link" href="/oss/integrations/text_embedding/nomic" arrow="true" cta="查看指南" />
<Card title="N
