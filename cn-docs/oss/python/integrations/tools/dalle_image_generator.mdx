---
title: Dall-E 图像生成器
---
>[OpenAI Dall-E](https://openai.com/dall-e-3) 是由 OpenAI 开发的文生图模型，它使用深度学习方法，根据自然语言描述（称为“提示词”）生成数字图像。

本笔记本展示了如何使用 OpenAI 大语言模型（LLM）合成的提示词来生成图像。图像由 `Dall-E` 生成，它使用与 LLM 相同的 OpenAI API 密钥。

```python
pip install -qU  opencv-python scikit-image langchain-community
```

```python
import os
from langchain_openai import OpenAI

os.environ["OPENAI_API_KEY"] = "insertapikey"
```

## 作为链（Chain）运行

```python
from langchain_classic.chains import LLMChain
from langchain_community.utilities.dalle_image_generator import DallEAPIWrapper
from langchain_core.prompts import PromptTemplate
from langchain_openai import OpenAI

llm = OpenAI(temperature=0.9)
prompt = PromptTemplate(
    input_variables=["image_desc"],
    template="根据以下描述，生成一个详细的提示词来创建图像：{image_desc}",
)
chain = LLMChain(llm=llm, prompt=prompt)
```

```python
image_url = DallEAPIWrapper().run(chain.run("halloween night at a haunted museum"))
```

```python
image_url
```

```python
# 你可以点击上面的链接来显示图像

try:
    import google.colab

    IN_COLAB = True
except ImportError:
    IN_COLAB = False

if IN_COLAB:
    from google.colab.patches import cv2_imshow  # for image display
    from skimage import io

    image = io.imread(image_url)
    cv2_imshow(image)
else:
    import cv2
    from skimage import io

    image = io.imread(image_url)
    cv2.imshow("image", image)
    cv2.waitKey(0)  # wait for a keyboard input
    cv2.destroyAllWindows()
```

## 作为智能体（Agent）的工具运行

```python
from langchain_community.tools.openai_dalle_image_generation import (
    OpenAIDALLEImageGenerationTool,
)
from langchain_community.utilities.dalle_image_generator import DallEAPIWrapper
from langchain_openai import ChatOpenAI
from langchain.agents import create_agent


llm = ChatOpenAI(model="gpt-3.5-turbo", temperature=0)
api_wrapper = DallEAPIWrapper()
dalle_tool = OpenAIDALLEImageGenerationTool(api_wrapper=api_wrapper)

tools = [dalle_tool]

agent = create_agent(llm, tools, debug=True)

# 用户提示词
prompt = "Create an image of a halloween night at a haunted museum"

messages = [
    # "role": "user" 表示消息来自用户
    # "content": prompt 是放置用户输入的地方
    {"role": "user", "content": prompt}
]

# 将消息发送给 ChatGPT 进行处理和调整，然后通过 DALL-E 生成图像
response = agent.invoke({"messages": messages})

print(response)
```
