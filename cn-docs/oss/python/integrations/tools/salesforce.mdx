---
title: Salesforce
---
一个使用 LangChain 与 Salesforce CRM 交互的工具。

## 概述

`langchain-salesforce` 包将 LangChain 与 Salesforce CRM 集成，允许您从 LangChain 应用程序中查询数据、管理记录和探索对象模式。

### 主要特性

- **SOQL 查询**：执行 Salesforce 对象查询语言 (SOQL) 查询
- **对象管理**：对 Salesforce 对象执行创建、读取、更新和删除 (CRUD) 操作
- **模式探索**：描述对象模式并列出可用对象
- **异步支持**：支持异步操作
- **错误处理**：详细的错误信息
- **环境变量支持**：从环境变量加载凭据

## 安装

安装所需的依赖项：

```bash
 pip install langchain-salesforce
 ```

## 身份验证设置

这些环境变量将被集成自动获取。

## 获取您的安全令牌

如果您需要一个安全令牌：

1.  登录 Salesforce
2.  进入设置
3.  在"我的个人信息"下点击"重置我的安全令牌"
4.  在您的电子邮件中查收新令牌

### 环境变量（推荐）

将您的 Salesforce 凭据设置为环境变量：

```bash
export SALESFORCE_USERNAME="your-username@company.com"
export SALESFORCE_PASSWORD="your-password"
export SALESFORCE_SECURITY_TOKEN="your-security-token"
export SALESFORCE_DOMAIN="login"  # 对于沙盒环境，请使用 "test"
```

## 实例化

```python
import os

from langchain_salesforce import SalesforceTool

username = os.getenv("SALESFORCE_USERNAME", "your-username")
password = os.getenv("SALESFORCE_PASSWORD", "your-password")
security_token = os.getenv("SALESFORCE_SECURITY_TOKEN", "your-security-token")
domain = os.getenv("SALESFORCE_DOMAIN", "login")

tool = SalesforceTool(
    username=username, password=password, security_token=security_token, domain=domain
)
```

## 调用

```python
def execute_salesforce_operation(
    operation, object_name=None, query=None, record_data=None, record_id=None
):
    """执行给定的 Salesforce 操作。"""
    request = {"operation": operation}
    if object_name:
        request["object_name"] = object_name
    if query:
        request["query"] = query
    if record_data:
        request["record_data"] = record_data
    if record_id:
        request["record_id"] = record_id
    result = tool.invoke(request)
    return result
```

## 查询

此示例查询 Salesforce 中的 5 个联系人。

```python
query_result = execute_salesforce_operation(
    operation="query", query="SELECT Id, Name, Email FROM Contact LIMIT 5"
)
```

## 描述对象

获取特定 Salesforce 对象的元数据。

```python
describe_result = execute_salesforce_operation(
    operation="describe", object_name="Account"
)
```

## 列出可用对象

检索 Salesforce 实例中所有可用的对象。

```python
list_objects_result = execute_salesforce_operation(operation="list_objects")
```

## 创建新联系人

在 Salesforce 中创建新的联系人记录。

```python
create_result = execute_salesforce_operation(
    operation="create",
    object_name="Contact",
    record_data={"LastName": "Doe", "Email": "doe@example.com"},
)
```

## 更新联系人

更新现有的联系人记录。

```python
update_result = execute_salesforce_operation(
    operation="update",
    object_name="Contact",
    record_id="003XXXXXXXXXXXXXXX",
    record_data={"Email": "updated@example.com"},
)
```

## 删除联系人

从 Salesforce 中删除联系人记录。

```python
delete_result = execute_salesforce_operation(
    operation="delete", object_name="Contact", record_id="003XXXXXXXXXXXXXXX"
)
```

## 链式调用

```python
from langchain_anthropic import ChatAnthropic
from langchain.messages import HumanMessage
from langchain_salesforce import SalesforceTool

# 初始化 Salesforce 工具
tool = SalesforceTool(
    username=username, password=password, security_token=security_token, domain=domain
)

# 初始化 Anthropic LLM
llm = ChatAnthropic(model="claude-sonnet-4-5-20250929")

# 首先，查询一些联系人以获取真实数据
contacts_query = {
    "operation": "query",
    "query": "SELECT Id, Name, Email, Phone FROM Contact LIMIT 3",
}

contacts_result = tool.invoke(contacts_query)

# 现在使用 LLM 分析和总结联系人数据
if contacts_result and "records" in contacts_result:
    contact_data = contacts_result["records"]

    # 创建一条消息，要求 LLM 分析联系人数据
    analysis_prompt = f"""
    请分析以下 Salesforce 联系人数据并提供见解：

    联系人数据：{contact_data}

    请提供：
    1. 联系人摘要
    2. 您注意到的任何模式
    3. 数据质量改进建议
    """

    message = HumanMessage(content=analysis_prompt)
    analysis_result = llm.invoke([message])

    print("\nLLM 分析：")
    print(analysis_result.content)
```

---

## API 参考

有关完整的文档和 API 参考，请参阅：

- [langchain-salesforce README](https://github.com/colesmcintosh/langchain-salesforce/blob/main/README.md)
- [Simple Salesforce 文档](https://simple-salesforce.readthedocs.io/en/latest/)

## 其他资源

- [Salesforce SOQL 参考](https://developer.salesforce.com/docs/atlas.en-us.soql_sosl.meta/soql_sosl/)
- [Salesforce REST API 开发者指南](https://developer.salesforce.com/docs/atlas.en-us.api_rest.meta/api_rest/)
