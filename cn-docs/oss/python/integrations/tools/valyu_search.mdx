---
title: ValyuContext
---
>[Valyu](https://www.valyu.network/) 允许 AI 应用和智能体在互联网及专有数据源中搜索相关的、可供大语言模型使用的信息。

本笔记本将介绍如何在 LangChain 中使用 Valyu 上下文工具。

首先，获取一个 Valyu API 密钥并将其设置为环境变量。通过[在此注册](https://platform.valyu.network/)可获得 10 美元免费额度。

## 概述

### 集成详情

| 类                                                         | 包                                                        | 可序列化 | JS 支持 |  版本 |
|:--------------------------------------------------------------|:---------------------------------------------------------------| :---: | :---: | :---: |
| [Valyu Search](https://github.com/valyu-network/langchain-valyu) | [langchain-valyu](https://pypi.org/project/langchain-valyu/) | ✅ | ❌  |  ![PyPI - Version](https://img.shields.io/pypi/v/langchain-valyu?style=flat-square&label=%20) |

## 设置

该集成位于 `langchain-valyu` 包中。

```python
pip install -qU langchain-valyu
```

为了使用该包，您还需要将 `VALYU_API_KEY` 环境变量设置为您的 Valyu API 密钥。

```python
import getpass
import os

if not os.environ.get("VALYU_API_KEY"):
    os.environ["VALYU_API_KEY"] = getpass.getpass("Valyu API key:\n")
```

## 实例化

这里我们展示如何实例化 Valyu 搜索工具。该工具允许您使用 Valyu 的 Context API 端点完成搜索查询。

```python
from langchain_valyu import ValyuSearchTool

tool = ValyuSearchTool()
```

## 调用

### 直接使用参数调用

Valyu 搜索工具在调用时接受以下参数：

- `query` (必需)：一个自然语言搜索查询
- `search_type` (可选)：搜索类型，例如 "all"
- `max_num_results` (可选)：返回的最大结果数
- `similarity_threshold` (可选)：结果的相似度阈值
- `query_rewrite` (可选)：是否重写查询
- `max_price` (可选)：搜索的最高价格

出于可靠性和性能原因，某些参数可能是必需的或受限制的。详情请参阅 [Valyu API 文档](https://docs.valyu.network/overview)。

```python
search_results = tool._run(
    query="What are agentic search-enhanced large reasoning models?",
    search_type="all",
    max_num_results=5,
    similarity_threshold=0.4,
    query_rewrite=False,
    max_price=20.0,
)

print("Search Results:", search_results)
```

## 在智能体中使用

我们可以通过将工具绑定到智能体，直接在智能体执行器中使用我们的工具。这使得智能体能够动态设置 Valyu 搜索工具的可用参数。

```python
if not os.environ.get("OPENAI_API_KEY"):
    os.environ["OPENAI_API_KEY"] = getpass.getpass("OPENAI_API_KEY:\n")
```

```python
# | output: false
# | echo: false

# !pip install -qU langchain langchain-openai
from langchain.chat_models import init_chat_model

model = init_chat_model(model="gpt-4o", model_provider="openai", temperature=0)
```

```python
from langchain_valyu import ValyuSearchTool
from langchain.agents import create_agent


valyu_search_tool = ValyuSearchTool()

agent = create_agent(model, [valyu_search_tool])

user_input = "What are the key factors driving recent stock market volatility, and how do macroeconomic indicators influence equity prices across different sectors?"

for step in agent.stream(
    {"messages": user_input},
    stream_mode="values",
):
    step["messages"][-1].pretty_print()
```

---

## API 参考

有关 Valyu Context API 所有功能和配置的详细文档，请访问 API 参考：[docs.valyu.network/overview](https://docs.valyu.network/overview)
