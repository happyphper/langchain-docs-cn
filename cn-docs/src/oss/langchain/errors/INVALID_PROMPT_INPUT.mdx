---
title: 无效提示输入
---
{/* TODO: 移植页面时修复链接 */}
当 [提示模板](https://github.com/langchain-ai/langchain/blob/v0.3/docs/docs/concepts/prompt_templates.mdx) 接收到缺失或无效的输入变量时发生。

:::js
一个可能意外导致此错误的方式是，如果你直接将一个 JSON 对象添加到提示模板中：

```typescript
import { PromptTemplate } from "@langchain/core/prompts";
import { ChatOpenAI } from "@langchain/openai";

const prompt = PromptTemplate.fromTemplate(`You are a helpful assistant.

Here is an example of how you should respond:

{
  "firstName": "John",
  "lastName": "Doe",
  "age": 21
}

Now, answer the following question:

{question}`);
```

你可能会认为上面的提示模板应该只需要一个名为 `question` 的输入键，但 JSON 对象将被解释为一个额外的变量，因为花括号 (`{`) 没有被转义，应该在其前面加上第二个花括号，像这样：

```typescript
import { PromptTemplate } from "@langchain/core/prompts";
import { ChatOpenAI } from "@langchain/openai";

const prompt = PromptTemplate.fromTemplate(`You are a helpful assistant.

Here is an example of how you should respond:

{{
  "firstName": "John",
  "lastName": "Doe",
  "age": 21
}}

Now, answer the following question:

{question}`);
```
:::


## 故障排除

要解决此错误，你可以：

1.  检查你的提示模板是否正确。使用 f-string 格式时，确保正确转义花括号：
    *   在 f-strings 中使用 `{{` 表示单个花括号
    *   在 f-strings 中使用 `{{{{` 表示双花括号
2.  使用 `MessagesPlaceholder` 组件时，确认你传递的是消息数组或类似消息的对象。如果使用简写元组，请将变量名用花括号包裹，如 `["placeholder", "{messages}"]`
3.  通过使用 [LangSmith](/langsmith/home) 或日志记录来检查提示模板的实际输入，以验证它们是否符合预期
4.  如果从 LangChain [Prompt Hub](https://smith.langchain.com/prompts) 获取提示，请使用示例输入隔离并测试提示，以确保其按预期工作
