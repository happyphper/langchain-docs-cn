---
title: äººæœºååŒ
---
äººæœºååŒï¼ˆHuman-in-the-Loopï¼ŒHITLï¼‰[ä¸­é—´ä»¶](/oss/langchain/middleware/built-in#human-in-the-loop)å…è®¸æ‚¨ä¸ºæ™ºèƒ½ä½“ï¼ˆagentï¼‰çš„å·¥å…·è°ƒç”¨æ·»åŠ äººå·¥ç›‘ç£ã€‚
å½“æ¨¡å‹æå‡ºä¸€ä¸ªå¯èƒ½éœ€è¦å®¡æŸ¥çš„æ“ä½œæ—¶â€”â€”ä¾‹å¦‚å†™å…¥æ–‡ä»¶æˆ–æ‰§è¡Œ SQLâ€”â€”è¯¥ä¸­é—´ä»¶å¯ä»¥æš‚åœæ‰§è¡Œå¹¶ç­‰å¾…å†³ç­–ã€‚

å®ƒé€šè¿‡æ ¹æ®å¯é…ç½®çš„ç­–ç•¥æ£€æŸ¥æ¯ä¸ªå·¥å…·è°ƒç”¨æ¥å®ç°æ­¤åŠŸèƒ½ã€‚å¦‚æœéœ€è¦å¹²é¢„ï¼Œä¸­é—´ä»¶ä¼šå‘å‡ºä¸€ä¸ª @[interrupt]ï¼Œä»è€Œåœæ­¢æ‰§è¡Œã€‚å›¾çŠ¶æ€ä¼šä½¿ç”¨ LangGraph çš„[æŒä¹…åŒ–å±‚](/oss/langgraph/persistence)ä¿å­˜ï¼Œå› æ­¤æ‰§è¡Œå¯ä»¥å®‰å…¨åœ°æš‚åœå¹¶åœ¨ç¨åæ¢å¤ã€‚

ç„¶åï¼Œäººå·¥å†³ç­–å°†å†³å®šæ¥ä¸‹æ¥å‘ç”Ÿä»€ä¹ˆï¼šæ“ä½œå¯ä»¥æŒ‰åŸæ ·æ‰¹å‡†ï¼ˆ`approve`ï¼‰ã€åœ¨è¿è¡Œå‰ä¿®æ”¹ï¼ˆ`edit`ï¼‰ï¼Œæˆ–è€…æ‹’ç»å¹¶é™„å¸¦åé¦ˆï¼ˆ`reject`ï¼‰ã€‚

## ä¸­æ–­å†³ç­–ç±»å‹

è¯¥[ä¸­é—´ä»¶](/oss/langchain/middleware/built-in#human-in-the-loop)å®šä¹‰äº†ä¸‰ç§å†…ç½®çš„äººå·¥å“åº”ä¸­æ–­çš„æ–¹å¼ï¼š

| å†³ç­–ç±»å‹ | æè¿°                                                                 | ç¤ºä¾‹ç”¨ä¾‹                                     |
|---------------|---------------------------------------------------------------------------|-----------------------------------------------------|
| âœ… `approve`   | æ“ä½œæŒ‰åŸæ ·æ‰¹å‡†å¹¶æ‰§è¡Œï¼Œä¸åšæ›´æ”¹ã€‚                | å®Œå…¨æŒ‰ç…§è‰ç¨¿å‘é€ç”µå­é‚®ä»¶              |
| âœï¸ `edit`     | å·¥å…·è°ƒç”¨åœ¨æ‰§è¡Œå‰è¢«ä¿®æ”¹ã€‚                             | åœ¨å‘é€ç”µå­é‚®ä»¶å‰æ›´æ”¹æ”¶ä»¶äºº        |
| âŒ `reject`    | å·¥å…·è°ƒç”¨è¢«æ‹’ç»ï¼Œå¹¶åœ¨å¯¹è¯ä¸­æ·»åŠ è§£é‡Šã€‚ | æ‹’ç»ç”µå­é‚®ä»¶è‰ç¨¿å¹¶è§£é‡Šå¦‚ä½•é‡å†™å®ƒ |

æ¯ä¸ªå·¥å…·å¯ç”¨çš„å†³ç­–ç±»å‹å–å†³äºæ‚¨åœ¨ `interrupt_on` ä¸­é…ç½®çš„ç­–ç•¥ã€‚
å½“å¤šä¸ªå·¥å…·è°ƒç”¨åŒæ—¶æš‚åœæ—¶ï¼Œæ¯ä¸ªæ“ä½œéƒ½éœ€è¦å•ç‹¬çš„å†³ç­–ã€‚
å†³ç­–å¿…é¡»æŒ‰ç…§ä¸­æ–­è¯·æ±‚ä¸­æ“ä½œå‡ºç°çš„é¡ºåºæä¾›ã€‚

<Tip>
**ç¼–è¾‘**å·¥å…·å‚æ•°æ—¶ï¼Œè¯·ä¿å®ˆåœ°è¿›è¡Œæ›´æ”¹ã€‚å¯¹åŸå§‹å‚æ•°çš„é‡å¤§ä¿®æ”¹å¯èƒ½å¯¼è‡´æ¨¡å‹é‡æ–°è¯„ä¼°å…¶æ–¹æ³•ï¼Œå¹¶å¯èƒ½å¤šæ¬¡æ‰§è¡Œè¯¥å·¥å…·æˆ–é‡‡å–æ„å¤–æ“ä½œã€‚
</Tip>


## é…ç½®ä¸­æ–­

è¦ä½¿ç”¨ HITLï¼Œè¯·åœ¨åˆ›å»ºæ™ºèƒ½ä½“æ—¶å°†è¯¥[ä¸­é—´ä»¶](/oss/langchain/middleware/built-in#human-in-the-loop)æ·»åŠ åˆ°æ™ºèƒ½ä½“çš„ `middleware` åˆ—è¡¨ä¸­ã€‚

æ‚¨éœ€è¦é…ç½®ä¸€ä¸ªä»å·¥å…·æ“ä½œåˆ°æ¯ä¸ªæ“ä½œå…è®¸çš„å†³ç­–ç±»å‹çš„æ˜ å°„ã€‚å½“å·¥å…·è°ƒç”¨ä¸æ˜ å°„ä¸­çš„æŸä¸ªæ“ä½œåŒ¹é…æ—¶ï¼Œä¸­é—´ä»¶å°†ä¸­æ–­æ‰§è¡Œã€‚

:::python
```python
from langchain.agents import create_agent
from langchain.agents.middleware import HumanInTheLoopMiddleware # [!code highlight]
from langgraph.checkpoint.memory import InMemorySaver # [!code highlight]


agent = create_agent(
    model="gpt-4o",
    tools=[write_file_tool, execute_sql_tool, read_data_tool],
    middleware=[
        HumanInTheLoopMiddleware( # [!code highlight]
            interrupt_on={
                "write_file": True,  # å…è®¸æ‰€æœ‰å†³ç­–ï¼ˆapprove, edit, rejectï¼‰
                "execute_sql": {"allowed_decisions": ["approve", "reject"]},  # ä¸å…è®¸ç¼–è¾‘
                # å®‰å…¨æ“ä½œï¼Œæ— éœ€æ‰¹å‡†
                "read_data": False,
            },
            # ä¸­æ–­æ¶ˆæ¯çš„å‰ç¼€ - ä¸å·¥å…·åç§°å’Œå‚æ•°ç»„åˆå½¢æˆå®Œæ•´æ¶ˆæ¯
            # ä¾‹å¦‚ï¼š"Tool execution pending approval: execute_sql with query='DELETE FROM...'"
            # å•ä¸ªå·¥å…·å¯ä»¥é€šè¿‡åœ¨å…¶ä¸­æ–­é…ç½®ä¸­æŒ‡å®š "description" æ¥è¦†ç›–æ­¤è®¾ç½®
            description_prefix="Tool execution pending approval",
        ),
    ],
    # äººæœºååŒéœ€è¦æ£€æŸ¥ç‚¹ï¼ˆcheckpointingï¼‰æ¥å¤„ç†ä¸­æ–­ã€‚
    # åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¯·ä½¿ç”¨æŒä¹…åŒ–çš„æ£€æŸ¥ç‚¹ä¿å­˜å™¨ï¼Œå¦‚ AsyncPostgresSaverã€‚
    checkpointer=InMemorySaver(),  # [!code highlight]
)
```
:::

:::js
```ts
import { createAgent, humanInTheLoopMiddleware } from "langchain"; // [!code highlight]
import { MemorySaver } from "@langchain/langgraph"; // [!code highlight]

const agent = createAgent({
    model: "gpt-4o",
    tools: [writeFileTool, executeSQLTool, readDataTool],
    middleware: [
        humanInTheLoopMiddleware({
            interruptOn: {
                write_file: true, // å…è®¸æ‰€æœ‰å†³ç­–ï¼ˆapprove, edit, rejectï¼‰
                execute_sql: {
                    allowedDecisions: ["approve", "reject"],
                    // ä¸å…è®¸ç¼–è¾‘
                    description: "ğŸš¨ SQL execution requires DBA approval",
                },
                // å®‰å…¨æ“ä½œï¼Œæ— éœ€æ‰¹å‡†
                read_data: false,
            },
            // ä¸­æ–­æ¶ˆæ¯çš„å‰ç¼€ - ä¸å·¥å…·åç§°å’Œå‚æ•°ç»„åˆå½¢æˆå®Œæ•´æ¶ˆæ¯
            # ä¾‹å¦‚ï¼š"Tool execution pending approval: execute_sql with query='DELETE FROM...'"
            # å•ä¸ªå·¥å…·å¯ä»¥é€šè¿‡åœ¨å…¶ä¸­æ–­é…ç½®ä¸­æŒ‡å®š "description" æ¥è¦†ç›–æ­¤è®¾ç½®
            descriptionPrefix: "Tool execution pending approval",
        }),
    ],
    // äººæœºååŒéœ€è¦æ£€æŸ¥ç‚¹ï¼ˆcheckpointingï¼‰æ¥å¤„ç†ä¸­æ–­ã€‚
    // åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¯·ä½¿ç”¨æŒä¹…åŒ–çš„æ£€æŸ¥ç‚¹ä¿å­˜å™¨ï¼Œå¦‚ AsyncPostgresSaverã€‚
    checkpointer: new MemorySaver(), // [!code highlight]
});
```
:::


<Info>
    æ‚¨å¿…é¡»é…ç½®ä¸€ä¸ªæ£€æŸ¥ç‚¹ä¿å­˜å™¨ï¼ˆcheckpointerï¼‰ï¼Œä»¥ä¾¿åœ¨ä¸­æ–­ä¹‹é—´æŒä¹…åŒ–å›¾çŠ¶æ€ã€‚
    åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¯·ä½¿ç”¨æŒä¹…åŒ–çš„æ£€æŸ¥ç‚¹ä¿å­˜å™¨ï¼Œå¦‚ @[`AsyncPostgresSaver`]ã€‚å¯¹äºæµ‹è¯•æˆ–åŸå‹è®¾è®¡ï¼Œå¯ä»¥ä½¿ç”¨ @[`InMemorySaver`]ã€‚

    åœ¨è°ƒç”¨æ™ºèƒ½ä½“æ—¶ï¼Œä¼ é€’ä¸€ä¸ªåŒ…å«**çº¿ç¨‹ ID** çš„ `config`ï¼Œä»¥ä¾¿å°†æ‰§è¡Œä¸ä¼šè¯çº¿ç¨‹å…³è”èµ·æ¥ã€‚
    è¯¦æƒ…è¯·å‚é˜… [LangGraph ä¸­æ–­æ–‡æ¡£](/oss/langgraph/interrupts)ã€‚
</Info>

<Accordion title="é…ç½®é€‰é¡¹">

:::python
<ParamField body="interrupt_on" type="dict" required>
    å·¥å…·åç§°åˆ°æ‰¹å‡†é…ç½®çš„æ˜ å°„ã€‚å€¼å¯ä»¥æ˜¯ `True`ï¼ˆä½¿ç”¨é»˜è®¤é…ç½®ä¸­æ–­ï¼‰ã€`False`ï¼ˆè‡ªåŠ¨æ‰¹å‡†ï¼‰æˆ–ä¸€ä¸ª `InterruptOnConfig` å¯¹è±¡ã€‚
</ParamField>

<ParamField body="description_prefix" type="string" default="Tool execution requires approval">
    æ“ä½œè¯·æ±‚æè¿°çš„å‰ç¼€
</ParamField>

**`InterruptOnConfig` é€‰é¡¹ï¼š**

<ParamField body="allowed_decisions" type="list[string]">
    å…è®¸çš„å†³ç­–åˆ—è¡¨ï¼š`'approve'`ã€`'edit'` æˆ– `'reject'`
</ParamField>

<ParamField body="description" type="string | callable">
    ç”¨äºè‡ªå®šä¹‰æè¿°çš„é™æ€å­—ç¬¦ä¸²æˆ–å¯è°ƒç”¨å‡½æ•°
</ParamField>
:::

:::js
<ParamField body="interruptOn" type="object" required>
    å·¥å…·åç§°åˆ°æ‰¹å‡†é…ç½®çš„æ˜ å°„
</ParamField>

**å·¥å…·æ‰¹å‡†é…ç½®é€‰é¡¹ï¼š**

<ParamField body="allowAccept" type="boolean" default="false">
    æ˜¯å¦å…è®¸æ‰¹å‡†
</ParamField>

<ParamField body="allowEdit" type="boolean" default="false">
    æ˜¯å¦å…è®¸ç¼–è¾‘
</ParamField>

<ParamField body="allowRespond" type="boolean" default="false">
    æ˜¯å¦å…è®¸å“åº”/æ‹’ç»
</ParamField>
:::

</Accordion>

## å“åº”ä¸­æ–­

å½“æ‚¨è°ƒç”¨æ™ºèƒ½ä½“æ—¶ï¼Œå®ƒä¼šä¸€ç›´è¿è¡Œç›´åˆ°å®Œæˆæˆ–å¼•å‘ä¸­æ–­ã€‚å½“å·¥å…·è°ƒç”¨ä¸æ‚¨åœ¨ `interrupt_on` ä¸­é…ç½®çš„ç­–ç•¥åŒ¹é…æ—¶ï¼Œä¼šè§¦å‘ä¸­æ–­ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè°ƒç”¨ç»“æœå°†åŒ…å«ä¸€ä¸ª `__interrupt__` å­—æ®µï¼Œå…¶ä¸­åˆ—å‡ºäº†éœ€è¦å®¡æŸ¥çš„æ“ä½œã€‚ç„¶åï¼Œæ‚¨å¯ä»¥å°†è¿™äº›æ“ä½œå‘ˆç°ç»™å®¡æŸ¥è€…ï¼Œå¹¶åœ¨æä¾›å†³ç­–åæ¢å¤æ‰§è¡Œã€‚


:::python
```python
from langgraph.types import Command

# äººæœºååŒåˆ©ç”¨ LangGraph çš„æŒä¹…åŒ–å±‚ã€‚
# æ‚¨å¿…é¡»æä¾›ä¸€ä¸ªçº¿ç¨‹ ID æ¥å°†æ‰§è¡Œä¸ä¼šè¯çº¿ç¨‹å…³è”ï¼Œ
# ä»¥ä¾¿å¯ä»¥æš‚åœå’Œæ¢å¤å¯¹è¯ï¼ˆè¿™æ˜¯äººå·¥å®¡æŸ¥æ‰€éœ€è¦çš„ï¼‰ã€‚
config = {"configurable": {"thread_id": "some_id"}} # [!code highlight]
# è¿è¡Œå›¾ç›´åˆ°é‡åˆ°ä¸­æ–­ã€‚
result = agent.invoke(
    {
        "messages": [
            {
                "role": "user",
                "content": "Delete old records from the database",
            }
        ]
    },
    config=config # [!code highlight]
)

# ä¸­æ–­åŒ…å«å®Œæ•´çš„ HITL è¯·æ±‚ï¼ŒåŒ…æ‹¬ action_requests å’Œ review_configs
print(result['__interrupt__'])
# > [
# >    Interrupt(
# >       value={
# >          'action_requests': [
# >             {
# >                'name': 'execute_sql',
# >                'arguments': {'query': 'DELETE FROM records WHERE created_at < NOW() - INTERVAL \'30 days\';'},
# >                'description': 'Tool execution pending approval\n\nTool: execute_sql\nArgs: {...}'
# >             }
# >          ],
# >          'review_configs': [
# >             {
# >                'action_name': 'execute_sql',
# >                'allowed_decisions': ['approve', 'reject']
# >             }
# >          ]
# >       }
# >    )
# > ]


# ä½¿ç”¨æ‰¹å‡†å†³ç­–æ¢å¤æ‰§è¡Œ
agent.invoke(
    Command( # [!code highlight]
        resume={"decisions": [{"type": "approve"}]}  # æˆ– "reject" [!code highlight]
    ), # [!code highlight]
    config=config # ç›¸åŒçš„çº¿ç¨‹ ID ä»¥æ¢å¤æš‚åœçš„å¯¹è¯
)
```
:::

:::js
```typescript
import { HumanMessage } from "@langchain/core/messages";
import { Command } from "@langchain/langgraph";

// æ‚¨å¿…é¡»æä¾›ä¸€ä¸ªçº¿ç¨‹ ID æ¥å°†æ‰§è¡Œä¸ä¼šè¯çº¿ç¨‹å…³è”ï¼Œ
// ä»¥ä¾¿å¯ä»¥æš‚åœå’Œæ¢å¤å¯¹è¯ï¼ˆè¿™æ˜¯äººå·¥å®¡æŸ¥æ‰€éœ€è¦çš„ï¼‰ã€‚
const config = { configurable: { thread_id: "some_id" } }; // [!code highlight]

// è¿è¡Œå›¾ç›´åˆ°é‡åˆ°ä¸­æ–­ã€‚
const result = await agent.invoke(
    {
        messages: [new HumanMessage("Delete old records from the database")],
    },
    config // [!code highlight]
);


// ä¸­æ–­åŒ…å«å®Œæ•´çš„ HITL è¯·æ±‚ï¼ŒåŒ…æ‹¬ action_requests å’Œ review_configs
console.log(result.__interrupt__);
// > [
// >    Interrupt(
// >       value: {
// >          action_requests: [
// >             {
// >                name: 'execute_sql',
// >                arguments: { query: 'DELETE FROM records WHERE created_at < NOW() - INTERVAL \'30 days\';' },
// >                description: 'Tool execution pending approval\n\nTool: execute_sql\nArgs: {...}'
// >             }
// >          ],
// >          review_configs: [
// >             {
// >                action_name: 'execute_sql',
// >                allowed_decisions: ['approve', 'reject']
// >             }
// >          ]
// >       }
// >    )
// > ]

// ä½¿ç”¨æ‰¹å‡†å†³ç­–æ¢å¤æ‰§è¡Œ
await agent.invoke(
    new Command({ // [!code highlight]
        resume: { decisions: [{ type: "approve" }] }, // æˆ– "reject" [!code highlight]
    }), // [!code highlight]
    config // ç›¸åŒçš„çº¿ç¨‹ ID ä»¥æ¢å¤æš‚åœçš„å¯¹è¯
);
```
:::

### å†³ç­–ç±»å‹

<Tabs>
<Tab title="âœ… approve">
ä½¿ç”¨ `approve` æŒ‰åŸæ ·æ‰¹å‡†å·¥å…·è°ƒç”¨å¹¶æ‰§è¡Œï¼Œä¸åšæ›´æ”¹ã€‚

:::python
```python
agent.invoke(
    Command(
        # å†³ç­–ä»¥åˆ—è¡¨å½¢å¼æä¾›ï¼Œæ¯ä¸ªè¢«å®¡æŸ¥çš„æ“ä½œä¸€ä¸ªã€‚
        # å†³ç­–çš„é¡ºåºå¿…é¡»ä¸ `__interrupt__` è¯·æ±‚ä¸­åˆ—å‡ºçš„æ“ä½œé¡ºåºåŒ¹é…ã€‚
        resume={
            "decisions": [
                {
                    "type": "approve",
                }
            ]
        }
    ),
    config=config  # ç›¸åŒçš„çº¿ç¨‹ ID ä»¥æ¢å¤æš‚åœçš„å¯¹è¯
)
```
:::

:::js
```typescript
await agent.invoke(
    new Command({
        // å†³ç­–ä»¥åˆ—è¡¨å½¢å¼æä¾›ï¼Œæ¯ä¸ªè¢«å®¡æŸ¥çš„æ“ä½œä¸€ä¸ªã€‚
        // å†³ç­–çš„é¡ºåºå¿…é¡»ä¸ `__interrupt__` è¯·æ±‚ä¸­åˆ—å‡ºçš„æ“ä½œé¡ºåºåŒ¹é…ã€‚
        resume: {
            decisions: [
                {
                    type: "approve",
                }
            ]
        }
    }),
    config  // ç›¸åŒçš„çº¿ç¨‹ ID ä»¥æ¢å¤æš‚åœçš„å¯¹è¯
);
```
:::
</Tab>
<Tab title="âœï¸ edit">
    ä½¿ç”¨ `edit` åœ¨æ‰§è¡Œå‰ä¿®æ”¹å·¥å…·è°ƒç”¨ã€‚
    æä¾›ç¼–è¾‘åçš„æ“ä½œï¼ŒåŒ…å«æ–°çš„å·¥å…·åç§°å’Œå‚æ•°ã€‚

    :::python
    ```python
    agent.invoke(
        Command(
            # å†³ç­–ä»¥åˆ—è¡¨å½¢å¼æä¾›ï¼Œæ¯ä¸ªè¢«å®¡æŸ¥çš„æ“ä½œä¸€ä¸ªã€‚
            # å†³ç­–çš„é¡ºåºå¿…é¡»ä¸ `__interrupt__` è¯·æ±‚ä¸­åˆ—å‡ºçš„æ“ä½œé¡ºåºåŒ¹é…ã€‚
            resume={
                "decisions": [
                    {
                        "type": "edit",
                        # ç¼–è¾‘åçš„æ“ä½œï¼ŒåŒ…å«å·¥å…·åç§°å’Œå‚æ•°
                        "edited_action": {
                            # è¦è°ƒç”¨çš„å·¥å…·åç§°ã€‚
                            # é€šå¸¸ä¸åŸå§‹æ“ä½œç›¸åŒã€‚
                            "name": "new_tool_name",
                            # ä¼ é€’ç»™å·¥å…·çš„å‚æ•°ã€‚
                            "args": {"key1": "new_value", "key2": "original_value"},
                        }
                    }
                ]
            }
        ),
        config=config  # ç›¸åŒçš„çº¿ç¨‹ ID ä»¥æ¢å¤æš‚åœçš„å¯¹è¯
    )
    ```
    :::

    :::js
    ```typescript
    await agent.invoke(
        new Command({
            // å†³ç­–ä»¥åˆ—è¡¨å½¢å¼æä¾›ï¼Œæ¯ä¸ªè¢«å®¡æŸ¥çš„æ“ä½œä¸€ä¸ªã€‚
            // å†³ç­–çš„é¡ºåºå¿…é¡»ä¸ `__interrupt__` è¯·æ±‚ä¸­åˆ—å‡ºçš„æ“ä½œé¡ºåºåŒ¹é…ã€‚
            resume: {
                decisions: [
                    {
                        type: "edit",
                        // ç¼–è¾‘åçš„æ“ä½œï¼ŒåŒ…å«å·¥å…·åç§°å’Œå‚æ•°
                        editedAction: {
                            // è¦è°ƒç”¨çš„å·¥å…·åç§°ã€‚
                            // é€šå¸¸ä¸åŸå§‹æ“ä½œç›¸åŒã€‚
                            name: "new_tool_name",
                            // ä¼ é€’ç»™å·¥å…·çš„å‚æ•°ã€‚
                            args: { key1: "new_value", key2: "original_value" },
                        }
                    }
                ]
            }
        }),
        config  // ç›¸åŒçš„çº¿ç¨‹ ID ä»¥æ¢å¤æš‚åœçš„å¯¹è¯
    );
    ```
    :::

    <Tip>
        **ç¼–è¾‘**å·¥å…·å‚æ•°æ—¶ï¼Œè¯·ä¿å®ˆåœ°è¿›è¡Œæ›´æ”¹ã€‚å¯¹åŸå§‹å‚æ•°çš„é‡å¤§ä¿®æ”¹å¯èƒ½å¯¼è‡´æ¨¡å‹é‡æ–°è¯„ä¼°å…¶æ–¹æ³•ï¼Œå¹¶å¯èƒ½å¤šæ¬¡æ‰§è¡Œè¯¥å·¥å…·æˆ–é‡‡å–æ„å¤–æ“ä½œã€‚
    </Tip>

</Tab>

<Tab title="âŒ reject">
    ä½¿ç”¨ `reject` æ‹’ç»å·¥å…·è°ƒç”¨ï¼Œå¹¶æä¾›åé¦ˆè€Œä¸æ˜¯æ‰§è¡Œã€‚

    :::python
    ```python
    agent.invoke(
        Command(
            # å†³ç­–ä»¥åˆ—è¡¨å½¢å¼æä¾›ï¼Œæ¯ä¸ªè¢«å®¡æŸ¥çš„æ“ä½œä¸€ä¸ªã€‚
            # å†³ç­–çš„é¡ºåºå¿…é¡»ä¸ `__interrupt__` è¯·æ±‚ä¸­åˆ—å‡ºçš„æ“ä½œé¡ºåºåŒ¹é…ã€‚
            resume={
                "decisions": [
                    {
                        "type": "reject",
                        # å…³äºä¸ºä»€ä¹ˆæ‹’ç»è¯¥æ“ä½œçš„è§£é‡Š
                        "message": "No, this is wrong because ..., instead do this ...",
                    }
                ]
            }
        ),
        config=config  # ç›¸åŒçš„çº¿ç¨‹ ID ä»¥æ¢å¤æš‚åœçš„å¯¹è¯
    )
    ```
    :::

    :::js
    ```typescript
    await agent.invoke(
        new Command({
            // å†³ç­–ä»¥åˆ—è¡¨å½¢å¼æä¾›ï¼Œæ¯ä¸ªè¢«å®¡æŸ¥çš„æ“ä½œä¸€ä¸ªã€‚
            // å†³ç­–çš„é¡ºåºå¿…é¡»ä¸ `__interrupt__` è¯·æ±‚ä¸­åˆ—å‡ºçš„æ“ä½œé¡ºåºåŒ¹é…ã€‚
            resume: {
                decisions: [
                    {
                        type: "reject",
                        // å…³äºä¸ºä»€ä¹ˆæ‹’ç»è¯¥æ“ä½œçš„è§£é‡Š
                        message: "No, this is wrong because ..., instead do this ...",
                    }
                ]
            }
        }),
        config  // ç›¸åŒçš„çº¿ç¨‹ ID ä»¥æ¢å¤æš‚åœçš„å¯¹è¯
    );
    ```
    :::

`message` ä¼šä½œä¸ºåé¦ˆæ·»åŠ åˆ°å¯¹è¯ä¸­ï¼Œä»¥å¸®åŠ©æ™ºèƒ½ä½“ç†è§£ä¸ºä»€ä¹ˆæ“ä½œè¢«æ‹’ç»ä»¥åŠå®ƒåº”è¯¥åšä»€ä¹ˆã€‚

---

### å¤šä¸ªå†³ç­–

å½“å¤šä¸ªæ“ä½œéœ€è¦å®¡æŸ¥æ—¶ï¼Œä¸ºæ¯ä¸ªæ“ä½œæä¾›ä¸€ä¸ªå†³ç­–ï¼Œé¡ºåºä¸å®ƒä»¬åœ¨ä¸­æ–­ä¸­å‡ºç°çš„é¡ºåºç›¸åŒï¼š

:::python
```python
{
    "decisions": [
        {"type": "approve"},
        {
            "type": "edit",
            "edited_action": {
                "name": "tool_name",
                "args": {"param": "new_value"}
            }
        },
        {
            "type": "reject",
            "message": "This action is not allowed"
        }
    ]
}
```
:::

:::js
```typescript
{
    decisions: [
        { type: "approve" },
        {
            type: "edit",
            editedAction: {
                name: "tool_name",
                args: { param: "new_value" }
            }
        },
        {
            type: "reject",
            message: "This action is not allowed"
        }
    ]
}
```
:::

</Tab>
</Tabs>

## äººæœºååŒæµå¼å¤„ç†

æ‚¨å¯ä»¥ä½¿ç”¨ `stream()` ä»£æ›¿ `invoke()`ï¼Œä»¥ä¾¿åœ¨æ™ºèƒ½ä½“è¿è¡Œå’Œå¤„ç†ä¸­æ–­æ—¶è·å¾—å®æ—¶æ›´æ–°ã€‚ä½¿ç”¨ `stream_mode=['updates', 'messages']` æ¥åŒæ—¶æµå¼ä¼ è¾“æ™ºèƒ½ä½“è¿›åº¦å’Œ LLM ä»¤ç‰Œã€‚

:::python
```python
from langgraph.types import Command

config = {"configurable": {"thread_id": "some_id"}}

# æµå¼ä¼ è¾“æ™ºèƒ½ä½“è¿›åº¦å’Œ LLM ä»¤ç‰Œç›´åˆ°ä¸­æ–­
for mode, chunk in agent.stream(
    {"messages": [{"role": "user", "content": "Delete old records from the database"}]},
    config=config,
    stream_mode=["updates", "messages"],  # [!code highlight]
):
    if mode == "messages":
        # LLM ä»¤ç‰Œ
        token, metadata = chunk
        if token.content:
            print(token.content, end="", flush=True)
    elif mode == "updates":
        # æ£€æŸ¥ä¸­æ–­
        if "__interrupt__" in chunk:
            print(f"\n\nInterrupt: {chunk['__interrupt__']}")

# åœ¨äººå·¥å†³ç­–åæ¢å¤æµå¼ä¼ è¾“
for mode, chunk in agent.stream(
    Command(resume={"decisions": [{"type": "approve"}]}),
    config=config,
    stream_mode=["updates", "messages"],
):
    if mode == "messages":
        token, metadata = chunk
        if token.content:
            print(token.content, end="", flush=True)
```
:::

:::js
```typescript
import { Command } from "@langchain/langgraph";

const config = { configurable: { thread_id: "some_id" } };

// æµå¼ä¼ è¾“æ™ºèƒ½ä½“è¿›åº¦å’Œ LLM ä»¤ç‰Œç›´åˆ°ä¸­æ–­
for await (const [mode, chunk] of await agent.stream(
    { messages: [{ role: "user", content: "Delete old records from the database" }] },
    { ...config, streamMode: ["updates", "messages"] }  // [!code highlight]
)) {
    if (mode === "messages") {
        // LLM ä»¤ç‰Œ
        const [token, metadata] = chunk;
        if (token.content) {
            process.stdout.write(token.content);
        }
    } else if (mode === "updates") {
        // æ£€æŸ¥ä¸­æ–­
        if ("__interrupt__" in chunk) {
            console.log(`\n\nInterrupt: ${JSON.stringify(chunk
