---
title: æ„å»ºä¸€ä¸ªå…·å¤‡æŒ‰éœ€æŠ€èƒ½çš„ SQL åŠ©æ‰‹
sidebarTitle: 'Skills: SQL assistant'
---
import ChatModelTabsPy from '/snippets/chat-model-tabs.mdx';
import ChatModelTabsJs from '/snippets/chat-model-tabs-js.mdx';

æœ¬æ•™ç¨‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨**æ¸è¿›å¼æŠ«éœ²**â€”â€”ä¸€ç§ä¸Šä¸‹æ–‡ç®¡ç†æŠ€æœ¯ï¼Œæ™ºèƒ½ä½“æŒ‰éœ€åŠ è½½ä¿¡æ¯è€Œéé¢„å…ˆåŠ è½½â€”â€”æ¥å®ç°**æŠ€èƒ½**ï¼ˆåŸºäºæç¤ºçš„ä¸“ç”¨æŒ‡ä»¤ï¼‰ã€‚æ™ºèƒ½ä½“é€šè¿‡å·¥å…·è°ƒç”¨åŠ è½½æŠ€èƒ½ï¼Œè€Œä¸æ˜¯åŠ¨æ€æ›´æ”¹ç³»ç»Ÿæç¤ºï¼Œä»…å‘ç°å¹¶åŠ è½½æ¯ä¸ªä»»åŠ¡æ‰€éœ€çš„æŠ€èƒ½ã€‚

**ä½¿ç”¨åœºæ™¯ï¼š** å‡è®¾æ‚¨æ­£åœ¨æ„å»ºä¸€ä¸ªæ™ºèƒ½ä½“ï¼Œä»¥å¸®åŠ©åœ¨å¤§å‹ä¼ä¸šçš„ä¸åŒä¸šåŠ¡å‚ç›´é¢†åŸŸç¼–å†™ SQL æŸ¥è¯¢ã€‚æ‚¨çš„ç»„ç»‡å¯èƒ½ä¸ºæ¯ä¸ªå‚ç›´é¢†åŸŸè®¾ç½®äº†ç‹¬ç«‹çš„æ•°æ®å­˜å‚¨ï¼Œæˆ–è€…æ‹¥æœ‰ä¸€ä¸ªåŒ…å«æ•°åƒå¼ è¡¨çš„å•ä¸€å•ä½“æ•°æ®åº“ã€‚æ— è®ºå“ªç§æƒ…å†µï¼Œé¢„å…ˆåŠ è½½æ‰€æœ‰æ¨¡å¼éƒ½ä¼šè¶…å‡ºä¸Šä¸‹æ–‡çª—å£çš„å®¹é‡ã€‚æ¸è¿›å¼æŠ«éœ²é€šè¿‡ä»…åœ¨éœ€è¦æ—¶åŠ è½½ç›¸å…³æ¨¡å¼æ¥è§£å†³æ­¤é—®é¢˜ã€‚è¿™ç§æ¶æ„è¿˜ä½¿ä¸åŒçš„äº§å“æ‰€æœ‰è€…å’Œåˆ©ç›Šç›¸å…³è€…èƒ½å¤Ÿç‹¬ç«‹è´¡çŒ®å’Œç»´æŠ¤å…¶ç‰¹å®šä¸šåŠ¡å‚ç›´é¢†åŸŸçš„æŠ€èƒ½ã€‚

**æ‚¨å°†æ„å»ºçš„å†…å®¹ï¼š** ä¸€ä¸ªå…·æœ‰ä¸¤ç§æŠ€èƒ½ï¼ˆé”€å”®åˆ†æå’Œåº“å­˜ç®¡ç†ï¼‰çš„ SQL æŸ¥è¯¢åŠ©æ‰‹ã€‚æ™ºèƒ½ä½“åœ¨å…¶ç³»ç»Ÿæç¤ºä¸­çœ‹åˆ°è½»é‡çº§çš„æŠ€èƒ½æè¿°ï¼Œç„¶åä»…åœ¨ç”¨æˆ·æŸ¥è¯¢ç›¸å…³æ—¶ï¼Œæ‰é€šè¿‡å·¥å…·è°ƒç”¨åŠ è½½å®Œæ•´çš„æ•°æ®åº“æ¨¡å¼å’Œä¸šåŠ¡é€»è¾‘ã€‚

<Note>
æœ‰å…³åŒ…å«æŸ¥è¯¢æ‰§è¡Œã€é”™è¯¯çº æ­£å’ŒéªŒè¯çš„æ›´å®Œæ•´ SQL æ™ºèƒ½ä½“ç¤ºä¾‹ï¼Œè¯·å‚é˜…æˆ‘ä»¬çš„ [SQL æ™ºèƒ½ä½“æ•™ç¨‹](/oss/langchain/sql-agent)ã€‚æœ¬æ•™ç¨‹é‡ç‚¹ä»‹ç»å¯åº”ç”¨äºä»»ä½•é¢†åŸŸçš„æ¸è¿›å¼æŠ«éœ²æ¨¡å¼ã€‚
</Note>

<Tip>
æ¸è¿›å¼æŠ«éœ²ç”± Anthropic æ¨å¹¿ï¼Œä½œä¸ºæ„å»ºå¯æ‰©å±•æ™ºèƒ½ä½“æŠ€èƒ½ç³»ç»Ÿçš„ä¸€ç§æŠ€æœ¯ã€‚è¿™ç§æ–¹æ³•é‡‡ç”¨ä¸‰çº§æ¶æ„ï¼ˆå…ƒæ•°æ® â†’ æ ¸å¿ƒå†…å®¹ â†’ è¯¦ç»†èµ„æºï¼‰ï¼Œæ™ºèƒ½ä½“ä»…åœ¨éœ€è¦æ—¶åŠ è½½ä¿¡æ¯ã€‚æœ‰å…³æ­¤æŠ€æœ¯çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜… [ä½¿ç”¨ Agent Skills ä¸ºæ™ºèƒ½ä½“é…å¤‡åº”å¯¹ç°å®ä¸–ç•Œçš„èƒ½åŠ›](https://www.anthropic.com/engineering/equipping-agents-for-the-real-world-with-agent-skills)ã€‚
</Tip>

## å·¥ä½œåŸç†

ä»¥ä¸‹æ˜¯ç”¨æˆ·è¯·æ±‚ SQL æŸ¥è¯¢æ—¶çš„æµç¨‹ï¼š

```mermaid
%%{init: {'theme':'base', 'themeVariables': { 'primaryColor':'#4CAF50','primaryTextColor':'#fff','primaryBorderColor':'#2E7D32','lineColor':'#666','secondaryColor':'#FF9800','tertiaryColor':'#2196F3','tertiaryBorderColor':'#1565C0','tertiaryTextColor':'#fff'}}}%%
flowchart TD
    Start([ğŸ’¬ ç”¨æˆ·ï¼šä¸ºé«˜ä»·å€¼å®¢æˆ·<br/>ç¼–å†™ SQL æŸ¥è¯¢]) --> SystemPrompt[ğŸ“‹ æ™ºèƒ½ä½“çœ‹åˆ°æŠ€èƒ½æè¿°ï¼š<br/>â€¢ sales_analytics<br/>â€¢ inventory_management]

    SystemPrompt --> Decide{ğŸ¤” éœ€è¦é”€å”®æ¨¡å¼å—ï¼Ÿ}

    Decide --> LoadSkill[ğŸ”§ load_skill<br/>'sales_analytics']

    LoadSkill --> Schema[ğŸ“Š æ¨¡å¼å·²åŠ è½½ï¼š<br/>customers, orders è¡¨<br/>+ ä¸šåŠ¡é€»è¾‘]

    Schema --> WriteQuery[âœï¸ æ™ºèƒ½ä½“ä½¿ç”¨æ¨¡å¼çŸ¥è¯†<br/>ç¼–å†™ SQL æŸ¥è¯¢]

    WriteQuery --> Response([âœ… è¿”å›éµå¾ªä¸šåŠ¡è§„åˆ™çš„<br/>æœ‰æ•ˆ SQL])

    %% Styling for light and dark modes
    classDef startEnd fill:#4CAF50,stroke:#2E7D32,stroke-width:2px,color:#fff
    classDef process fill:#FF9800,stroke:#E65100,stroke-width:2px,color:#fff
    classDef decision fill:#2196F3,stroke:#1565C0,stroke-width:2px,color:#fff
    classDef enrichment fill:#9C27B0,stroke:#6A1B9A,stroke-width:2px,color:#fff

    class Start,Response startEnd
    class SystemPrompt,LoadSkill,WriteQuery process
    class Decide decision
    class Schema enrichment
```

**ä¸ºä»€ä¹ˆä½¿ç”¨æ¸è¿›å¼æŠ«éœ²ï¼š**
- **å‡å°‘ä¸Šä¸‹æ–‡ä½¿ç”¨** - ä»…åŠ è½½ä»»åŠ¡æ‰€éœ€çš„ 2-3 é¡¹æŠ€èƒ½ï¼Œè€Œéæ‰€æœ‰å¯ç”¨æŠ€èƒ½
- **å®ç°å›¢é˜Ÿè‡ªæ²»** - ä¸åŒçš„å›¢é˜Ÿå¯ä»¥ç‹¬ç«‹å¼€å‘ä¸“é—¨çš„æŠ€èƒ½ï¼ˆç±»ä¼¼äºå…¶ä»–å¤šæ™ºèƒ½ä½“æ¶æ„ï¼‰
- **é«˜æ•ˆæ‰©å±•** - æ·»åŠ æ•°åæˆ–æ•°ç™¾é¡¹æŠ€èƒ½è€Œä¸ä¼šä½¿ä¸Šä¸‹æ–‡ä¸å ªé‡è´Ÿ
- **ç®€åŒ–å¯¹è¯å†å²** - å•ä¸€æ™ºèƒ½ä½“ï¼Œå•ä¸€å¯¹è¯çº¿ç¨‹

**ä»€ä¹ˆæ˜¯æŠ€èƒ½ï¼š** æŠ€èƒ½ï¼Œæ­£å¦‚ Claude Code æ‰€æ¨å¹¿çš„é‚£æ ·ï¼Œä¸»è¦æ˜¯åŸºäºæç¤ºçš„ï¼šå®ƒä»¬æ˜¯é’ˆå¯¹ç‰¹å®šä¸šåŠ¡ä»»åŠ¡çš„ã€è‡ªåŒ…å«çš„ä¸“ç”¨æŒ‡ä»¤å•å…ƒã€‚åœ¨ Claude Code ä¸­ï¼ŒæŠ€èƒ½ä»¥æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ç›®å½•å’Œæ–‡ä»¶å½¢å¼æš´éœ²ï¼Œé€šè¿‡æ–‡ä»¶æ“ä½œè¢«å‘ç°ã€‚æŠ€èƒ½é€šè¿‡æç¤ºæŒ‡å¯¼è¡Œä¸ºï¼Œå¯ä»¥æä¾›å·¥å…·ä½¿ç”¨ä¿¡æ¯ï¼Œæˆ–åŒ…å«ä¾›ç¼–ç æ™ºèƒ½ä½“æ‰§è¡Œçš„ç¤ºä¾‹ä»£ç ã€‚

<Tip>
å…·æœ‰æ¸è¿›å¼æŠ«éœ²åŠŸèƒ½çš„æŠ€èƒ½å¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§ [RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰](/oss/langchain/rag) å½¢å¼ï¼Œå…¶ä¸­æ¯ä¸ªæŠ€èƒ½éƒ½æ˜¯ä¸€ä¸ªæ£€ç´¢å•å…ƒâ€”â€”å°½ç®¡ä¸ä¸€å®šç”±åµŒå…¥æˆ–å…³é”®è¯æœç´¢æ”¯æŒï¼Œè€Œæ˜¯ç”±ç”¨äºæµè§ˆå†…å®¹çš„å·¥å…·æ”¯æŒï¼ˆå¦‚æ–‡ä»¶æ“ä½œï¼Œæˆ–åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œç›´æ¥æŸ¥æ‰¾ï¼‰ã€‚
</Tip>

**æƒè¡¡ï¼š**
- **å»¶è¿Ÿ**ï¼šæŒ‰éœ€åŠ è½½æŠ€èƒ½éœ€è¦é¢å¤–çš„å·¥å…·è°ƒç”¨ï¼Œè¿™ä¼šå¢åŠ é¦–æ¬¡éœ€è¦æ¯ä¸ªæŠ€èƒ½çš„è¯·æ±‚çš„å»¶è¿Ÿ
- **å·¥ä½œæµæ§åˆ¶**ï¼šåŸºæœ¬å®ç°ä¾èµ–æç¤ºæ¥æŒ‡å¯¼æŠ€èƒ½ä½¿ç”¨â€”â€”å¦‚æœæ²¡æœ‰è‡ªå®šä¹‰é€»è¾‘ï¼Œä½ æ— æ³•å¼ºåˆ¶æ‰§è¡Œç¡¬æ€§çº¦æŸï¼Œä¾‹å¦‚â€œå§‹ç»ˆå…ˆå°è¯•æŠ€èƒ½ Aï¼Œå†å°è¯•æŠ€èƒ½ Bâ€

<Tip>
**å®ç°ä½ è‡ªå·±çš„æŠ€èƒ½ç³»ç»Ÿ**

åœ¨æ„å»ºä½ è‡ªå·±çš„æŠ€èƒ½å®ç°æ—¶ï¼ˆæ­£å¦‚æˆ‘ä»¬åœ¨æœ¬æ•™ç¨‹ä¸­æ‰€åšï¼‰ï¼Œæ ¸å¿ƒæ¦‚å¿µæ˜¯æ¸è¿›å¼æŠ«éœ²â€”â€”æŒ‰éœ€åŠ è½½ä¿¡æ¯ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä½ åœ¨å®ç°ä¸Šæ‹¥æœ‰å®Œå…¨çš„çµæ´»æ€§ï¼š

- **å­˜å‚¨**ï¼šæ•°æ®åº“ã€S3ã€å†…å­˜æ•°æ®ç»“æ„æˆ–ä»»ä½•åç«¯
- **å‘ç°**ï¼šç›´æ¥æŸ¥æ‰¾ï¼ˆæœ¬æ•™ç¨‹ï¼‰ã€ç”¨äºå¤§å‹æŠ€èƒ½é›†åˆçš„ RAGã€æ–‡ä»¶ç³»ç»Ÿæ‰«ææˆ– API è°ƒç”¨
- **åŠ è½½é€»è¾‘**ï¼šè‡ªå®šä¹‰å»¶è¿Ÿç‰¹æ€§ï¼Œå¹¶æ·»åŠ é€»è¾‘ä»¥æœç´¢æŠ€èƒ½å†…å®¹æˆ–å¯¹ç›¸å…³æ€§è¿›è¡Œæ’åº
- **å‰¯ä½œç”¨**ï¼šå®šä¹‰æŠ€èƒ½åŠ è½½æ—¶å‘ç”Ÿçš„æƒ…å†µï¼Œä¾‹å¦‚æš´éœ²ä¸è¯¥æŠ€èƒ½å…³è”çš„å·¥å…·ï¼ˆåœ¨ç¬¬ 8 èŠ‚ä¸­ä»‹ç»ï¼‰

è¿™ç§çµæ´»æ€§è®©ä½ å¯ä»¥æ ¹æ®æ€§èƒ½ã€å­˜å‚¨å’Œå·¥ä½œæµæ§åˆ¶æ–¹é¢çš„ç‰¹å®šéœ€æ±‚è¿›è¡Œä¼˜åŒ–ã€‚
</Tip>

## è®¾ç½®

### å®‰è£…

æœ¬æ•™ç¨‹éœ€è¦ `langchain` åŒ…ï¼š

:::python
<CodeGroup>
```bash pip
pip install langchain
```
```bash uv
uv add langchain
```
```bash conda
conda install langchain -c conda-forge
```
</CodeGroup>
:::

:::js
<CodeGroup>
```bash npm
npm install langchain
```
```bash yarn
yarn add langchain
```
```bash pnpm
pnpm add langchain
```
</CodeGroup>
:::

æ›´å¤šè¯¦æƒ…ï¼Œè¯·å‚é˜…æˆ‘ä»¬çš„ [å®‰è£…æŒ‡å—](/oss/langchain/install)ã€‚

### LangSmith

è®¾ç½® [LangSmith](https://smith.langchain.com) ä»¥æ£€æŸ¥ä½ çš„æ™ºèƒ½ä½“å†…éƒ¨å‘ç”Ÿçš„æƒ…å†µã€‚ç„¶åè®¾ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

:::python
<CodeGroup>
```bash bash
export LANGSMITH_TRACING="true"
export LANGSMITH_API_KEY="..."
```
```python python
import getpass
import os

os.environ["LANGSMITH_TRACING"] = "true"
os.environ["LANGSMITH_API_KEY"] = getpass.getpass()
```
</CodeGroup>
:::

:::js
<CodeGroup>
```bash bash
export LANGSMITH_TRACING="true"
export LANGSMITH_API_KEY="..."
```
```typescript typescript
process.env.LANGSMITH_TRACING = "true";
process.env.LANGSMITH_API_KEY = "...";
```
</CodeGroup>
:::

### é€‰æ‹© LLM

ä» LangChain çš„é›†æˆå¥—ä»¶ä¸­é€‰æ‹©ä¸€ä¸ªèŠå¤©æ¨¡å‹ï¼š

:::python
<ChatModelTabsPy />
:::

:::js
<ChatModelTabsJs />
:::

## 1. å®šä¹‰æŠ€èƒ½

é¦–å…ˆï¼Œå®šä¹‰æŠ€èƒ½çš„ç»“æ„ã€‚æ¯ä¸ªæŠ€èƒ½éƒ½æœ‰ä¸€ä¸ªåç§°ã€ä¸€ä¸ªç®€è¦æè¿°ï¼ˆæ˜¾ç¤ºåœ¨ç³»ç»Ÿæç¤ºä¸­ï¼‰å’Œå®Œæ•´å†…å®¹ï¼ˆæŒ‰éœ€åŠ è½½ï¼‰ï¼š

:::python
```python
from typing import TypedDict

class Skill(TypedDict):  # [!code highlight]
    """A skill that can be progressively disclosed to the agent."""
    name: str  # Unique identifier for the skill
    description: str  # 1-2 sentence description to show in system prompt
    content: str  # Full skill content with detailed instructions
```
:::

:::js
```typescript
import { z } from "zod";

// ä¸€ç§å¯ä»¥é€æ­¥å‘æ™ºèƒ½ä½“ï¼ˆagentï¼‰æŠ«éœ²çš„æŠ€èƒ½
const SkillSchema = z.object({  // [!code highlight]
  name: z.string(),  // æŠ€èƒ½çš„å”¯ä¸€æ ‡è¯†ç¬¦
  description: z.string(),  // åœ¨ç³»ç»Ÿæç¤ºä¸­æ˜¾ç¤ºçš„ 1-2 å¥æè¿°
  content: z.string(),  // åŒ…å«è¯¦ç»†è¯´æ˜çš„å®Œæ•´æŠ€èƒ½å†…å®¹
});

type Skill = z.infer<typeof SkillSchema>;
```
:::

ç°åœ¨ä¸º SQL æŸ¥è¯¢åŠ©æ‰‹å®šä¹‰ç¤ºä¾‹æŠ€èƒ½ã€‚è¿™äº›æŠ€èƒ½è®¾è®¡ä¸º**æè¿°è½»é‡**ï¼ˆé¢„å…ˆå±•ç¤ºç»™æ™ºèƒ½ä½“ï¼‰ä½†**å†…å®¹è¯¦ç»†**ï¼ˆä»…åœ¨éœ€è¦æ—¶åŠ è½½ï¼‰ï¼š

<Accordion title="æŸ¥çœ‹å®Œæ•´çš„æŠ€èƒ½å®šä¹‰">

:::python
```python
SKILLS: list[Skill] = [
    {
        "name": "sales_analytics",
        "description": "ç”¨äºé”€å”®æ•°æ®åˆ†æçš„æ•°æ®åº“æ¨¡å¼å’Œä¸šåŠ¡é€»è¾‘ï¼ŒåŒ…æ‹¬å®¢æˆ·ã€è®¢å•å’Œæ”¶å…¥ã€‚",
        "content": """# é”€å”®åˆ†ææ¨¡å¼

## è¡¨

### customers
- customer_id (PRIMARY KEY)
- name
- email
- signup_date
- status (active/inactive)
- customer_tier (bronze/silver/gold/platinum)

### orders
- order_id (PRIMARY KEY)
- customer_id (FOREIGN KEY -> customers)
- order_date
- status (pending/completed/cancelled/refunded)
- total_amount
- sales_region (north/south/east/west)

### order_items
- item_id (PRIMARY KEY)
- order_id (FOREIGN KEY -> orders)
- product_id
- quantity
- unit_price
- discount_percent

## ä¸šåŠ¡é€»è¾‘

**æ´»è·ƒå®¢æˆ·**: status = 'active' AND signup_date <= CURRENT_DATE - INTERVAL '90 days'

**æ”¶å…¥è®¡ç®—**: ä»…ç»Ÿè®¡çŠ¶æ€ä¸º 'completed' çš„è®¢å•ã€‚ä½¿ç”¨ orders è¡¨ä¸­çš„ total_amountï¼Œè¯¥é‡‘é¢å·²è€ƒè™‘æŠ˜æ‰£ã€‚

**å®¢æˆ·ç»ˆèº«ä»·å€¼ (CLV)**: å®¢æˆ·æ‰€æœ‰å·²å®Œæˆè®¢å•é‡‘é¢çš„æ€»å’Œã€‚

**é«˜ä»·å€¼è®¢å•**: total_amount > 1000 çš„è®¢å•

## ç¤ºä¾‹æŸ¥è¯¢

-- è·å–ä¸Šä¸€å­£åº¦æŒ‰æ”¶å…¥æ’åçš„å‰ 10 åå®¢æˆ·
SELECT
    c.customer_id,
    c.name,
    c.customer_tier,
    SUM(o.total_amount) as total_revenue
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
WHERE o.status = 'completed'
  AND o.order_date >= CURRENT_DATE - INTERVAL '3 months'
GROUP BY c.customer_id, c.name, c.customer_tier
ORDER BY total_revenue DESC
LIMIT 10;
""",
    },
    {
        "name": "inventory_management",
        "description": "ç”¨äºåº“å­˜è·Ÿè¸ªçš„æ•°æ®åº“æ¨¡å¼å’Œä¸šåŠ¡é€»è¾‘ï¼ŒåŒ…æ‹¬äº§å“ã€ä»“åº“å’Œåº“å­˜æ°´å¹³ã€‚",
        "content": """# åº“å­˜ç®¡ç†æ¨¡å¼

## è¡¨

### products
- product_id (PRIMARY KEY)
- product_name
- sku
- category
- unit_cost
- reorder_point (minimum stock level before reordering)
- discontinued (boolean)

### warehouses
- warehouse_id (PRIMARY KEY)
- warehouse_name
- location
- capacity

### inventory
- inventory_id (PRIMARY KEY)
- product_id (FOREIGN KEY -> products)
- warehouse_id (FOREIGN KEY -> warehouses)
- quantity_on_hand
- last_updated

### stock_movements
- movement_id (PRIMARY KEY)
- product_id (FOREIGN KEY -> products)
- warehouse_id (FOREIGN KEY -> warehouses)
- movement_type (inbound/outbound/transfer/adjustment)
- quantity (positive for inbound, negative for outbound)
- movement_date
- reference_number

## ä¸šåŠ¡é€»è¾‘

**å¯ç”¨åº“å­˜**: inventory è¡¨ä¸­ quantity_on_hand > 0 çš„è®°å½•

**éœ€è¦è¡¥è´§çš„äº§å“**: æ‰€æœ‰ä»“åº“ä¸­ total quantity_on_hand å°äºæˆ–ç­‰äºäº§å“ reorder_point çš„äº§å“

**ä»…é™æ´»è·ƒäº§å“**: æ’é™¤ discontinued = true çš„äº§å“ï¼Œé™¤éä¸“é—¨åˆ†æå·²åœäº§çš„äº§å“

**åº“å­˜ä¼°å€¼**: æ¯ä¸ªäº§å“çš„ quantity_on_hand * unit_cost

## ç¤ºä¾‹æŸ¥è¯¢

-- æŸ¥æ‰¾æ‰€æœ‰ä»“åº“ä¸­ä½äºè¡¥è´§ç‚¹çš„äº§å“
SELECT
    p.product_id,
    p.product_name,
    p.reorder_point,
    SUM(i.quantity_on_hand) as total_stock,
    p.unit_cost,
    (p.reorder_point - SUM(i.quantity_on_hand)) as units_to_reorder
FROM products p
JOIN inventory i ON p.product_id = i.product_id
WHERE p.discontinued = false
GROUP BY p.product_id, p.product_name, p.reorder_point, p.unit_cost
HAVING SUM(i.quantity_on_hand) <= p.reorder_point
ORDER BY units_to_reorder DESC;
""",
    },
]
```
:::

:::js
```typescript
import { context } from "langchain";

const SKILLS: Skill[] = [
  {
    name: "sales_analytics",
    description:
      "ç”¨äºé”€å”®æ•°æ®åˆ†æï¼ˆåŒ…æ‹¬å®¢æˆ·ã€è®¢å•å’Œæ”¶å…¥ï¼‰çš„æ•°æ®åº“æ¨¡å¼å’Œä¸šåŠ¡é€»è¾‘ã€‚",
    content: context`
    # é”€å”®åˆ†ææ¨¡å¼

    ## è¡¨

    ### customers
    - customer_id (ä¸»é”®)
    - name
    - email
    - signup_date
    - status (active/inactive)
    - customer_tier (bronze/silver/gold/platinum)

    ### orders
    - order_id (ä¸»é”®)
    - customer_id (å¤–é”® -> customers)
    - order_date
    - status (pending/completed/cancelled/refunded)
    - total_amount
    - sales_region (north/south/east/west)

    ### order_items
    - item_id (ä¸»é”®)
    - order_id (å¤–é”® -> orders)
    - product_id
    - quantity
    - unit_price
    - discount_percent

    ## ä¸šåŠ¡é€»è¾‘

    **æ´»è·ƒå®¢æˆ·**:
    status = 'active' AND signup_date <= CURRENT_DATE - INTERVAL '90 days'

    **æ”¶å…¥è®¡ç®—**:
    ä»…ç»Ÿè®¡çŠ¶æ€ä¸º 'completed' çš„è®¢å•ã€‚
    ä½¿ç”¨ orders è¡¨ä¸­çš„ total_amountï¼Œè¯¥é‡‘é¢å·²è€ƒè™‘æŠ˜æ‰£ã€‚

    **å®¢æˆ·ç»ˆèº«ä»·å€¼ (CLV)**:
    å®¢æˆ·æ‰€æœ‰å·²å®Œæˆè®¢å•é‡‘é¢çš„æ€»å’Œã€‚

    **é«˜ä»·å€¼è®¢å•**:
    total_amount > 1000 çš„è®¢å•

    ## ç¤ºä¾‹æŸ¥è¯¢

    -- è·å–ä¸Šä¸€å­£åº¦æŒ‰æ”¶å…¥æ’åçš„å‰ 10 åå®¢æˆ·
    SELECT
        c.customer_id,
        c.name,
        c.customer_tier,
        SUM(o.total_amount) as total_revenue
    FROM customers c
    JOIN orders o ON c.customer_id = o.customer_id
    WHERE o.status = 'completed'
    AND o.order_date >= CURRENT_DATE - INTERVAL '3 months'
    GROUP BY c.customer_id, c.name, c.customer_tier
    ORDER BY total_revenue DESC
    LIMIT 10;`,
  },
  {
    name: "inventory_management",
    description:
      "ç”¨äºåº“å­˜è·Ÿè¸ªï¼ˆåŒ…æ‹¬äº§å“ã€ä»“åº“å’Œåº“å­˜æ°´å¹³ï¼‰çš„æ•°æ®åº“æ¨¡å¼å’Œä¸šåŠ¡é€»è¾‘ã€‚",
    content: context`
    # åº“å­˜ç®¡ç†æ¨¡å¼

    ## è¡¨

    ### products
    - product_id (ä¸»é”®)
    - product_name
    - sku
    - category
    - unit_cost
    - reorder_point (è¡¥è´§å‰çš„æœ€ä½åº“å­˜æ°´å¹³)
    - discontinued (å¸ƒå°”å€¼)

    ### warehouses
    - warehouse_id (ä¸»é”®)
    - warehouse_name
    - location
    - capacity

    ### inventory
    - inventory_id (ä¸»é”®)
    - product_id (å¤–é”® -> products)
    - warehouse_id (å¤–é”® -> warehouses)
    - quantity_on_hand
    - last_updated

    ### stock_movements
    - movement_id (ä¸»é”®)
    - product_id (å¤–é”® -> products)
    - warehouse_id (å¤–é”® -> warehouses)
    - movement_type (inbound/outbound/transfer/adjustment)
    - quantity (å…¥åº“ä¸ºæ­£æ•°ï¼Œå‡ºåº“ä¸ºè´Ÿæ•°)
    - movement_date
    - reference_number

    ## ä¸šåŠ¡é€»è¾‘

    **å¯ç”¨åº“å­˜**:
    inventory è¡¨ä¸­ quantity_on_hand > 0 çš„è®°å½•

    **éœ€è¦è¡¥è´§çš„äº§å“**:
    æ‰€æœ‰ä»“åº“ä¸­ quantity_on_hand æ€»å’Œå°äºæˆ–ç­‰äºäº§å“ reorder_point çš„äº§å“

    **ä»…é™æ´»è·ƒäº§å“**:
    é™¤éä¸“é—¨åˆ†æå·²åœäº§äº§å“ï¼Œå¦åˆ™æ’é™¤ discontinued = true çš„äº§å“

    **åº“å­˜ä¼°å€¼**:
    æ¯ä¸ªäº§å“çš„ quantity_on_hand * unit_cost

    ## ç¤ºä¾‹æŸ¥è¯¢

## 2. åˆ›å»ºæŠ€èƒ½åŠ è½½å·¥å…·

åˆ›å»ºä¸€ä¸ªå·¥å…·ï¼Œç”¨äºæŒ‰éœ€åŠ è½½å®Œæ•´çš„æŠ€èƒ½å†…å®¹ï¼š

:::python
```python
from langchain.tools import tool

@tool  # [!code highlight]
def load_skill(skill_name: str) -> str:
    """å°†æŠ€èƒ½çš„å®Œæ•´å†…å®¹åŠ è½½åˆ°æ™ºèƒ½ä½“ï¼ˆagentï¼‰çš„ä¸Šä¸‹æ–‡ä¸­ã€‚

    å½“ä½ éœ€è¦å…³äºå¦‚ä½•å¤„ç†ç‰¹å®šç±»å‹è¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯æ—¶ä½¿ç”¨æ­¤å·¥å…·ã€‚è¿™å°†ä¸ºä½ æä¾›è¯¥æŠ€èƒ½é¢†åŸŸçš„å…¨é¢è¯´æ˜ã€æ”¿ç­–å’ŒæŒ‡å—ã€‚

    Args:
        skill_name: è¦åŠ è½½çš„æŠ€èƒ½åç§°ï¼ˆä¾‹å¦‚ï¼š"expense_reporting", "travel_booking"ï¼‰
    """
    # æŸ¥æ‰¾å¹¶è¿”å›è¯·æ±‚çš„æŠ€èƒ½
    for skill in SKILLS:
        if skill["name"] == skill_name:
            return f"Loaded skill: {skill_name}\n\n{skill['content']}"  # [!code highlight]

    # æœªæ‰¾åˆ°æŠ€èƒ½
    available = ", ".join(s["name"] for s in SKILLS)
    return f"Skill '{skill_name}' not found. Available skills: {available}"
```
:::

:::js
```typescript
import { tool } from "langchain";
import { z } from "zod";

const loadSkill = tool(  // [!code highlight]
  async ({ skillName }) => {
    // æŸ¥æ‰¾å¹¶è¿”å›è¯·æ±‚çš„æŠ€èƒ½
    const skill = SKILLS.find((s) => s.name === skillName);
    if (skill) {
      return `Loaded skill: ${skillName}\n\n${skill.content}`;  // [!code highlight]
    }

    // æœªæ‰¾åˆ°æŠ€èƒ½
    const available = SKILLS.map((s) => s.name).join(", ");
    return `Skill '${skillName}' not found. Available skills: ${available}`;
  },
  {
    name: "load_skill",
    description: `å°†æŠ€èƒ½çš„å®Œæ•´å†…å®¹åŠ è½½åˆ°æ™ºèƒ½ä½“ï¼ˆagentï¼‰çš„ä¸Šä¸‹æ–‡ä¸­ã€‚

å½“ä½ éœ€è¦å…³äºå¦‚ä½•å¤„ç†ç‰¹å®šç±»å‹è¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯æ—¶ä½¿ç”¨æ­¤å·¥å…·ã€‚è¿™å°†ä¸ºä½ æä¾›è¯¥æŠ€èƒ½é¢†åŸŸçš„å…¨é¢è¯´æ˜ã€æ”¿ç­–å’ŒæŒ‡å—ã€‚`,
    schema: z.object({
      skillName: z.string().describe("è¦åŠ è½½çš„æŠ€èƒ½åç§°"),
    }),
  }
);
```
:::

`load_skill` å·¥å…·å°†å®Œæ•´çš„æŠ€èƒ½å†…å®¹ä½œä¸ºå­—ç¬¦ä¸²è¿”å›ï¼Œè¯¥å­—ç¬¦ä¸²ä½œä¸º ToolMessage æˆä¸ºå¯¹è¯çš„ä¸€éƒ¨åˆ†ã€‚æœ‰å…³åˆ›å»ºå’Œä½¿ç”¨å·¥å…·çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… [å·¥å…·æŒ‡å—](/oss/langchain/tools)ã€‚

## 3. æ„å»ºæŠ€èƒ½ä¸­é—´ä»¶

åˆ›å»ºè‡ªå®šä¹‰ä¸­é—´ä»¶ï¼Œå°†æŠ€èƒ½æè¿°æ³¨å…¥åˆ°ç³»ç»Ÿæç¤ºï¼ˆsystem promptï¼‰ä¸­ã€‚æ­¤ä¸­é—´ä»¶ä½¿æŠ€èƒ½å¯è¢«å‘ç°ï¼Œè€Œæ— éœ€é¢„å…ˆåŠ è½½å…¶å…¨éƒ¨å†…å®¹ã€‚

<Note>
æœ¬æŒ‡å—æ¼”ç¤ºäº†å¦‚ä½•åˆ›å»ºè‡ªå®šä¹‰ä¸­é—´ä»¶ã€‚æœ‰å…³ä¸­é—´ä»¶æ¦‚å¿µå’Œæ¨¡å¼çš„å…¨é¢æŒ‡å—ï¼Œè¯·å‚é˜… [è‡ªå®šä¹‰ä¸­é—´ä»¶æ–‡æ¡£](/oss/langchain/middleware/custom)ã€‚
</Note>

:::python
```python
from langchain.agents.middleware import ModelRequest, ModelResponse, AgentMiddleware
from langchain.messages import SystemMessage
from typing import Callable

class SkillMiddleware(AgentMiddleware):  # [!code highlight]
    """å°†æŠ€èƒ½æè¿°æ³¨å…¥åˆ°ç³»ç»Ÿæç¤ºï¼ˆsystem promptï¼‰ä¸­çš„ä¸­é—´ä»¶ã€‚"""

    # å°† load_skill å·¥å…·æ³¨å†Œä¸ºç±»å˜é‡
    tools = [load_skill]  # [!code highlight]

    def __init__(self):
        """åˆå§‹åŒ–å¹¶ä» SKILLS åˆ—è¡¨ç”ŸæˆæŠ€èƒ½æç¤ºï¼ˆpromptï¼‰ã€‚"""
        # ä» SKILLS åˆ—è¡¨æ„å»ºæŠ€èƒ½æç¤ºï¼ˆpromptï¼‰
        skills_list = []
        for skill in SKILLS:
            skills_list.append(
                f"- **{skill['name']}**: {skill['description']}"
            )
        self.skills_prompt = "\n".join(skills_list)
```

def wrap_model_call(
        self,
        request: ModelRequest,
        handler: Callable[[ModelRequest], ModelResponse],
    ) -> ModelResponse:
        """åŒæ­¥ï¼šå°†æŠ€èƒ½æè¿°æ³¨å…¥ç³»ç»Ÿæç¤ºã€‚"""
        # æ„å»ºæŠ€èƒ½é™„å½•
        skills_addendum = ( # [!code highlight]
            f"\n\n## å¯ç”¨æŠ€èƒ½\n\n{self.skills_prompt}\n\n" # [!code highlight]
            "å½“ä½ éœ€è¦å¤„ç†ç‰¹å®šç±»å‹è¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯æ—¶ï¼Œè¯·ä½¿ç”¨ load_skill å·¥å…·ã€‚" # [!code highlight]
        )

        # è¿½åŠ åˆ°ç³»ç»Ÿæ¶ˆæ¯å†…å®¹å—
        new_content = list(request.system_message.content_blocks) + [
            {"type": "text", "text": skills_addendum}
        ]
        new_system_message = SystemMessage(content=new_content)
        modified_request = request.override(system_message=new_system_message)
        return handler(modified_request)
```
:::

:::js
```typescript
import { createMiddleware } from "langchain";

// ä» SKILLS åˆ—è¡¨æ„å»ºæŠ€èƒ½æç¤º
const skillsPrompt = SKILLS.map(
  (skill) => `- **${skill.name}**: ${skill.description}`
).join("\n");

const skillMiddleware = createMiddleware({  // [!code highlight]
  name: "skillMiddleware",
  tools: [loadSkill],  // [!code highlight]
  wrapModelCall: async (request, handler) => {
    // æ„å»ºæŠ€èƒ½é™„å½•
    const skillsAddendum =  // [!code highlight]
      `\n\n## å¯ç”¨æŠ€èƒ½\n\n${skillsPrompt}\n\n` +  // [!code highlight]
      "å½“ä½ éœ€è¦å¤„ç†ç‰¹å®šç±»å‹è¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯æ—¶ï¼Œè¯·ä½¿ç”¨ load_skill å·¥å…·ã€‚" +  // [!code highlight]
      "about handling a specific type of request.";  // [!code highlight]

    // è¿½åŠ åˆ°ç³»ç»Ÿæç¤º
    const newSystemPrompt = request.systemPrompt + skillsAddendum;

    return handler({
      ...request,
      systemPrompt: newSystemPrompt,
    });
  },
});
```
:::

è¯¥ä¸­é—´ä»¶å°†æŠ€èƒ½æè¿°é™„åŠ åˆ°ç³»ç»Ÿæç¤ºä¸­ï¼Œä½¿æ™ºèƒ½ä½“ï¼ˆagentï¼‰èƒ½å¤Ÿäº†è§£å¯ç”¨æŠ€èƒ½ï¼Œè€Œæ— éœ€åŠ è½½å…¶å®Œæ•´å†…å®¹ã€‚`load_skill` å·¥å…·è¢«æ³¨å†Œä¸ºç±»å˜é‡ï¼Œä½¿å…¶å¯¹æ™ºèƒ½ä½“å¯ç”¨ã€‚

<Note>
**ç”Ÿäº§ç¯å¢ƒè€ƒè™‘**ï¼šæœ¬æ•™ç¨‹ä¸ºäº†ç®€å•èµ·è§ï¼Œåœ¨ `__init__` ä¸­åŠ è½½æŠ€èƒ½åˆ—è¡¨ã€‚åœ¨ç”Ÿäº§ç³»ç»Ÿä¸­ï¼Œä½ å¯èƒ½å¸Œæœ›æ”¹ä¸ºåœ¨ `before_agent` é’©å­ä¸­åŠ è½½æŠ€èƒ½ï¼Œä»¥ä¾¿èƒ½å¤Ÿå®šæœŸåˆ·æ–°æŠ€èƒ½ä»¥åæ˜ æœ€æ–°çš„æ›´æ”¹ï¼ˆä¾‹å¦‚ï¼Œå½“æ·»åŠ æ–°æŠ€èƒ½æˆ–ä¿®æ”¹ç°æœ‰æŠ€èƒ½æ—¶ï¼‰ã€‚è¯¦æƒ…è¯·å‚é˜… [before_agent é’©å­æ–‡æ¡£](/oss/langchain/middleware/custom#before_agent)ã€‚
</Note>

## 4. åˆ›å»ºæ”¯æŒæŠ€èƒ½çš„æ™ºèƒ½ä½“

ç°åœ¨åˆ›å»ºä¸€ä¸ªå¸¦æœ‰æŠ€èƒ½ä¸­é—´ä»¶å’Œç”¨äºçŠ¶æ€æŒä¹…åŒ–çš„æ£€æŸ¥ç‚¹ï¼ˆcheckpointerï¼‰çš„æ™ºèƒ½ä½“ï¼š

:::python
```python
from langchain.agents import create_agent
from langgraph.checkpoint.memory import InMemorySaver

# åˆ›å»ºæ”¯æŒæŠ€èƒ½çš„æ™ºèƒ½ä½“
agent = create_agent(
    model,
    system_prompt=(
        "ä½ æ˜¯ä¸€ä¸ª SQL æŸ¥è¯¢åŠ©æ‰‹ï¼Œå¸®åŠ©ç”¨æˆ· "
        "ç¼–å†™é’ˆå¯¹ä¸šåŠ¡æ•°æ®åº“çš„æŸ¥è¯¢ã€‚"
    ),
    middleware=[SkillMiddleware()],  # [!code highlight]
    checkpointer=InMemorySaver(),
)
```
:::

:::js
```typescript
import { createAgent } from "langchain";
import { MemorySaver } from "@langchain/langgraph";

// åˆ›å»ºæ”¯æŒæŠ€èƒ½çš„æ™ºèƒ½ä½“
const agent = createAgent({
  model,
  systemPrompt:
    "ä½ æ˜¯ä¸€ä¸ª SQL æŸ¥è¯¢åŠ©æ‰‹ï¼Œå¸®åŠ©ç”¨æˆ· " +
    "ç¼–å†™é’ˆå¯¹ä¸šåŠ¡æ•°æ®åº“çš„æŸ¥è¯¢ã€‚",
  middleware: [skillMiddleware],  // [!code highlight]
  checkpointer: new MemorySaver(),
});
```
:::

ç°åœ¨ï¼Œæ™ºèƒ½ä½“åœ¨å…¶ç³»ç»Ÿæç¤ºä¸­å¯ä»¥è®¿é—®æŠ€èƒ½æè¿°ï¼Œå¹¶ä¸”å¯ä»¥åœ¨éœ€è¦æ—¶è°ƒç”¨ `load_skill` æ¥æ£€ç´¢å®Œæ•´çš„æŠ€èƒ½å†…å®¹ã€‚æ£€æŸ¥ç‚¹ï¼ˆcheckpointerï¼‰åœ¨å¤šä¸ªå›åˆä¸­ç»´æŠ¤å¯¹è¯å†å²ã€‚

## 5. æµ‹è¯•æ¸è¿›å¼æŠ«éœ²

ç”¨ä¸€ä¸ªéœ€è¦ç‰¹å®šæŠ€èƒ½çŸ¥è¯†çš„é—®é¢˜æ¥æµ‹è¯•æ™ºèƒ½ä½“ï¼š

:::python
```python
import uuid

# æ­¤å¯¹è¯çº¿ç¨‹çš„é…ç½®
thread_id = str(uuid.uuid4())
config = {"configurable": {"thread_id": thread_id}}

# è¯·æ±‚ SQL æŸ¥è¯¢
result = agent.invoke(  # [!code highlight]
    {
        "messages": [
            {
                "role": "user",
                "content": (
                    "ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼ŒæŸ¥æ‰¾ä¸Šä¸ªæœˆè®¢å•é‡‘é¢è¶…è¿‡ 1000 ç¾å…ƒçš„æ‰€æœ‰å®¢æˆ·"
                ),
            }
        ]
    },
    config
)

# æ‰“å°å¯¹è¯
for message in result["messages"]:
    if hasattr(message, 'pretty_print'):
        message.pretty_print()
    else:
        print(f"{message.type}: {message.content}")
```
:::

:::js
```typescript
import { v4 as uuidv4 } from "uuid";

// æ­¤å¯¹è¯çº¿ç¨‹çš„é…ç½®
const threadId = uuidv4();
const config = { configurable: { thread_id: threadId } };

// è¯·æ±‚ SQL æŸ¥è¯¢
const result = await agent.invoke(  // [!code highlight]
  {
    messages: [
      {
        role: "user",
        content:
          "ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼ŒæŸ¥æ‰¾ä¸Šä¸ªæœˆè®¢å•é‡‘é¢è¶…è¿‡ 1000 ç¾å…ƒçš„æ‰€æœ‰å®¢æˆ·",
      },
    ],
  },
  config
);

// æ‰“å°å¯¹è¯
for (const message of result.messages) {
  console.log(`${message._getType()}: ${message.content}`);
}
```
:::

é¢„æœŸè¾“å‡ºï¼š

```
================================ Human Message =================================

ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼ŒæŸ¥æ‰¾ä¸Šä¸ªæœˆè®¢å•é‡‘é¢è¶…è¿‡ 1000 ç¾å…ƒçš„æ‰€æœ‰å®¢æˆ·
================================== Ai Message ==================================
å·¥å…·è°ƒç”¨ï¼š
  load_skill (call_abc123)
 è°ƒç”¨ ID: call_abc123
  å‚æ•°ï¼š
    skill_name: sales_analytics
================================= Tool Message =================================
åç§°: load_skill

å·²åŠ è½½æŠ€èƒ½: sales_analytics

# é”€å”®åˆ†ææ¨¡å¼

## è¡¨

### customers
- customer_id (ä¸»é”®)
- name
- email
- signup_date
- status (active/inactive)
- customer_tier (bronze/silver/gold/platinum)

### orders
- order_id (ä¸»é”®)
- customer_id (å¤–é”® -> customers)
- order_date
- status (pending/completed/cancelled/refunded)
- total_amount
- sales_region (north/south/east/west)

[... å…¶ä½™æ¨¡å¼ ...]

## ä¸šåŠ¡é€»è¾‘

**é«˜ä»·å€¼è®¢å•**: `total_amount > 1000` çš„è®¢å•
**æ”¶å…¥è®¡ç®—**: ä»…ç»Ÿè®¡ `status = 'completed'` çš„è®¢å•

================================== Ai Message ==================================

è¿™æ˜¯ä¸€ä¸ªæŸ¥æ‰¾ä¸Šä¸ªæœˆè®¢å•é‡‘é¢è¶…è¿‡ 1000 ç¾å…ƒçš„æ‰€æœ‰å®¢æˆ·çš„ SQL æŸ¥è¯¢ï¼š

\`\`\`sql
SELECT DISTINCT
    c.customer_id,
    c.name,
    c.email,
    c.customer_tier
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
WHERE o.total_amount > 1000
  AND o.status = 'completed'
  AND o.order_date >= CURRENT_DATE - INTERVAL '1 month'
ORDER BY c.customer_id;
\`\`\`

æ­¤æŸ¥è¯¢ï¼š
- å°†å®¢æˆ·ä¸å…¶è®¢å•è¿æ¥
- ä½¿ç”¨ total_amount å­—æ®µç­›é€‰é«˜ä»·å€¼è®¢å• (>$1000)
- ä»…åŒ…å«å·²å®Œæˆçš„è®¢å•ï¼ˆæ ¹æ®ä¸šåŠ¡é€»è¾‘ï¼‰
- é™åˆ¶ä¸ºä¸Šä¸ªæœˆçš„è®¢å•
- è¿”å›ä¸åŒçš„å®¢æˆ·ï¼Œä»¥é¿å…ä»–ä»¬ä¸‹å¤šä¸ªç¬¦åˆæ¡ä»¶çš„è®¢å•æ—¶å‡ºç°é‡å¤
```

æ™ºèƒ½ä½“ï¼ˆagentï¼‰åœ¨å…¶ç³»ç»Ÿæç¤ºä¸­çœ‹åˆ°äº†è½»é‡çº§çš„æŠ€èƒ½æè¿°ï¼Œè¯†åˆ«å‡ºé—®é¢˜éœ€è¦é”€å”®æ•°æ®åº“çŸ¥è¯†ï¼Œè°ƒç”¨ `load_skill("sales_analytics")` æ¥è·å–å®Œæ•´çš„æ¨¡å¼ï¼ˆschemaï¼‰å’Œä¸šåŠ¡é€»è¾‘ï¼Œç„¶åä½¿ç”¨è¿™äº›ä¿¡æ¯ç¼–å†™äº†ä¸€ä¸ªéµå¾ªæ•°æ®åº“çº¦å®šçš„æ­£ç¡®æŸ¥è¯¢ã€‚

## 6. é«˜çº§ï¼šä½¿ç”¨è‡ªå®šä¹‰çŠ¶æ€æ·»åŠ çº¦æŸ

<Accordion title="å¯é€‰ï¼šè·Ÿè¸ªå·²åŠ è½½æŠ€èƒ½å¹¶å¼ºåˆ¶æ‰§è¡Œå·¥å…·çº¦æŸ">

æ‚¨å¯ä»¥æ·»åŠ çº¦æŸï¼Œä»¥å¼ºåˆ¶è§„å®šæŸäº›å·¥å…·ä»…åœ¨åŠ è½½äº†ç‰¹å®šæŠ€èƒ½åæ‰å¯ç”¨ã€‚è¿™éœ€è¦åœ¨è‡ªå®šä¹‰æ™ºèƒ½ä½“ï¼ˆagentï¼‰çŠ¶æ€ä¸­è·Ÿè¸ªå“ªäº›æŠ€èƒ½å·²è¢«åŠ è½½ã€‚

### å®šä¹‰è‡ªå®šä¹‰çŠ¶æ€

é¦–å…ˆï¼Œæ‰©å±•æ™ºèƒ½ä½“ï¼ˆagentï¼‰çŠ¶æ€ä»¥è·Ÿè¸ªå·²åŠ è½½çš„æŠ€èƒ½ï¼š

:::python
```python
from langchain.agents.middleware import AgentState

class CustomState(AgentState):  # [!code highlight]
    skills_loaded: NotRequired[list[str]]  # è·Ÿè¸ªå“ªäº›æŠ€èƒ½å·²è¢«åŠ è½½  # [!code highlight]
```
:::

:::js
```typescript
import { z } from "zod";

const CustomStateSchema = z.object({
  skillsLoaded: z.array(z.string()).optional(),  // è¿½è¸ªå·²åŠ è½½çš„æŠ€èƒ½  // [!code highlight]
});
```
:::

### æ›´æ–° load_skill ä»¥ä¿®æ”¹çŠ¶æ€

ä¿®æ”¹ `load_skill` å·¥å…·ï¼Œä½¿å…¶åœ¨åŠ è½½æŠ€èƒ½æ—¶æ›´æ–°çŠ¶æ€ï¼š

:::python
```python
from langgraph.types import Command  # [!code highlight]
from langchain.tools import tool, ToolRuntime
from langchain.messages import ToolMessage  # [!code highlight]

@tool
def load_skill(skill_name: str, runtime: ToolRuntime) -> Command:  # [!code highlight]
    """å°†æŠ€èƒ½çš„å®Œæ•´å†…å®¹åŠ è½½åˆ°æ™ºèƒ½ä½“çš„ä¸Šä¸‹æ–‡ä¸­ã€‚

    å½“ä½ éœ€è¦å…³äºå¦‚ä½•å¤„ç†ç‰¹å®šç±»å‹è¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯æ—¶ä½¿ç”¨æ­¤å·¥å…·ã€‚è¿™å°†ä¸ºä½ æä¾›è¯¥æŠ€èƒ½é¢†åŸŸçš„å…¨é¢è¯´æ˜ã€æ”¿ç­–å’ŒæŒ‡å—ã€‚

    å‚æ•°:
        skill_name: è¦åŠ è½½çš„æŠ€èƒ½åç§°
    """
    # æŸ¥æ‰¾å¹¶è¿”å›è¯·æ±‚çš„æŠ€èƒ½
    for skill in SKILLS:
        if skill["name"] == skill_name:
            skill_content = f"Loaded skill: {skill_name}\n\n{skill['content']}"

            # æ›´æ–°çŠ¶æ€ä»¥è¿½è¸ªå·²åŠ è½½çš„æŠ€èƒ½
            return Command(  # [!code highlight]
                update={  # [!code highlight]
                    "messages": [  # [!code highlight]
                        ToolMessage(  # [!code highlight]
                            content=skill_content,  # [!code highlight]
                            tool_call_id=runtime.tool_call_id,  # [!code highlight]
                        )  # [!code highlight]
                    ],  # [!code highlight]
                    "skills_loaded": [skill_name],  # [!code highlight]
                }  # [!code highlight]
            )  # [!code highlight]

    # æœªæ‰¾åˆ°æŠ€èƒ½
    available = ", ".join(s["name"] for s in SKILLS)
    return Command(
        update={
            "messages": [
                ToolMessage(
                    content=f"Skill '{skill_name}' not found. Available skills: {available}",
                    tool_call_id=runtime.tool_call_id,
                )
            ]
        }
    )
```
:::

:::js
```typescript
import { tool, ToolMessage, type ToolRuntime } from "langchain";
import { Command } from "@langchain/langgraph";  // [!code highlight]
import { z } from "zod";

const loadSkill = tool(  // [!code highlight]
  async ({ skillName }, runtime: ToolRuntime<typeof CustomStateSchema>) => {
    // æŸ¥æ‰¾å¹¶è¿”å›è¯·æ±‚çš„æŠ€èƒ½
    const skill = SKILLS.find((s) => s.name === skillName);

    if (skill) {
      const skillContent = `Loaded skill: ${skillName}\n\n${skill.content}`;

      // æ›´æ–°çŠ¶æ€ä»¥è¿½è¸ªå·²åŠ è½½çš„æŠ€èƒ½
      return new Command({  // [!code highlight]
        update: {  // [!code highlight]
          messages: [  // [!code highlight]
            new ToolMessage({  // [!code highlight]
              content: skillContent,  // [!code highlight]
              tool_call_id: runtime.toolCallId,  // [!code highlight]
            }),  // [!code highlight]
          ],  // [!code highlight]
          skillsLoaded: [skillName],  // [!code highlight]
        },  // [!code highlight]
      });  // [!code highlight]
    }

    // æœªæ‰¾åˆ°æŠ€èƒ½
    const available = SKILLS.map((s) => s.name).join(", ");
    return new Command({
      update: {
        messages: [
          new ToolMessage({
            content: `Skill '${skillName}' not found. Available skills: ${available}`,
            tool_call_id: runtime.toolCallId,
          }),
        ],
      },
    });
  },
  {
    name: "load_skill",
    description: `å°†æŠ€èƒ½çš„å®Œæ•´å†…å®¹åŠ è½½åˆ°æ™ºèƒ½ä½“çš„ä¸Šä¸‹æ–‡ä¸­ã€‚`,
    schema: z.object({
      skillName: z.string().describe("è¦åŠ è½½çš„æŠ€èƒ½åç§°"),
    }),
  }
);
```
:::

### åˆ›å»ºå—çº¦æŸçš„å·¥å…·

åˆ›å»ºä¸€ä¸ªä»…åœ¨ç‰¹å®šæŠ€èƒ½åŠ è½½åæ‰å¯ç”¨çš„å·¥å…·ï¼š

:::python
```python
@tool
def write_sql_query(  # [!code highlight]
    query: str,
    vertical: str,
    runtime: ToolRuntime,
) -> str:
    """ä¸ºç‰¹å®šä¸šåŠ¡é¢†åŸŸç¼–å†™å’ŒéªŒè¯ SQL æŸ¥è¯¢ã€‚

    æ­¤å·¥å…·å¸®åŠ©æ ¼å¼åŒ–å’ŒéªŒè¯ SQL æŸ¥è¯¢ã€‚ä½ å¿…é¡»å…ˆåŠ è½½ç›¸åº”çš„æŠ€èƒ½ä»¥ç†è§£æ•°æ®åº“æ¨¡å¼ã€‚

    Args:
        query: è¦ç¼–å†™çš„ SQL æŸ¥è¯¢
        vertical: ä¸šåŠ¡é¢†åŸŸï¼ˆsales_analytics æˆ– inventory_managementï¼‰
    """
    # æ£€æŸ¥æ‰€éœ€çš„æŠ€èƒ½æ˜¯å¦å·²åŠ è½½
    skills_loaded = runtime.state.get("skills_loaded", [])  # [!code highlight]

    if vertical not in skills_loaded:  # [!code highlight]
        return (  # [!code highlight]
            f"é”™è¯¯ï¼šåœ¨ç¼–å†™æŸ¥è¯¢ä¹‹å‰ï¼Œä½ å¿…é¡»å…ˆåŠ è½½ '{vertical}' æŠ€èƒ½ "  # [!code highlight]
            f"ä»¥ç†è§£æ•°æ®åº“æ¨¡å¼ã€‚ "  # [!code highlight]
            f"ä½¿ç”¨ load_skill('{vertical}') æ¥åŠ è½½æ¨¡å¼ã€‚"  # [!code highlight]
        )  # [!code highlight]

    # éªŒè¯å¹¶æ ¼å¼åŒ–æŸ¥è¯¢
    return (
        f"{vertical} çš„ SQL æŸ¥è¯¢ï¼š\n\n"
        f"```sql\n{query}\n```\n\n"
        f"âœ“ æŸ¥è¯¢å·²æ ¹æ® {vertical} æ¨¡å¼éªŒè¯\n"
        f"å‡†å¤‡å¯¹æ•°æ®åº“æ‰§è¡Œã€‚"
    )
```
:::

:::js
```typescript
const writeSqlQuery = tool(  // [!code highlight]
  async ({ query, vertical }, runtime: ToolRuntime<typeof CustomStateSchema>) => {
    // æ£€æŸ¥æ‰€éœ€çš„æŠ€èƒ½æ˜¯å¦å·²åŠ è½½
    const skillsLoaded = runtime.state.skillsLoaded ?? [];  // [!code highlight]

    if (!skillsLoaded.includes(vertical)) {  // [!code highlight]
      return (  // [!code highlight]
        `é”™è¯¯ï¼šåœ¨ç¼–å†™æŸ¥è¯¢ä¹‹å‰ï¼Œä½ å¿…é¡»å…ˆåŠ è½½ '${vertical}' æŠ€èƒ½ ` +  // [!code highlight]
        `ä»¥ç†è§£æ•°æ®åº“æ¨¡å¼ã€‚ ` +  // [!code highlight]
        `ä½¿ç”¨ load_skill('${vertical}') æ¥åŠ è½½æ¨¡å¼ã€‚`  // [!code highlight]
      );  // [!code highlight]
    }

    // éªŒè¯å¹¶æ ¼å¼åŒ–æŸ¥è¯¢
    return (
      `${vertical} çš„ SQL æŸ¥è¯¢ï¼š\n\n` +
      `\`\`\`sql\n${query}\n\`\`\`\n\n` +
      `âœ“ æŸ¥è¯¢å·²æ ¹æ® ${vertical} æ¨¡å¼éªŒè¯\n` +
      `å‡†å¤‡å¯¹æ•°æ®åº“æ‰§è¡Œã€‚`
    );
  },
  {
    name: "write_sql_query",
    description: `ä¸ºç‰¹å®šä¸šåŠ¡é¢†åŸŸç¼–å†™å’ŒéªŒè¯ SQL æŸ¥è¯¢ã€‚

æ­¤å·¥å…·å¸®åŠ©æ ¼å¼åŒ–å’ŒéªŒè¯ SQL æŸ¥è¯¢ã€‚ä½ å¿…é¡»å…ˆåŠ è½½ç›¸åº”çš„æŠ€èƒ½ä»¥ç†è§£æ•°æ®åº“æ¨¡å¼ã€‚`,
    schema: z.object({
      query: z.string().describe("è¦ç¼–å†™çš„ SQL æŸ¥è¯¢"),
      vertical: z.string().describe("ä¸šåŠ¡é¢†åŸŸï¼ˆsales_analytics æˆ– inventory_managementï¼‰"),
    }),
  }
);
```
:::

### æ›´æ–°ä¸­é—´ä»¶å’Œæ™ºèƒ½ä½“

æ›´æ–°ä¸­é—´ä»¶ä»¥ä½¿ç”¨è‡ªå®šä¹‰çŠ¶æ€æ¨¡å¼ï¼š

:::python
```python
class SkillMiddleware(AgentMiddleware[CustomState]):  # [!code highlight]
    """å°†æŠ€èƒ½æè¿°æ³¨å…¥ç³»ç»Ÿæç¤ºçš„ä¸­é—´ä»¶ã€‚"""

    state_schema = CustomState  # [!code highlight]
    tools = [load_skill, write_sql_query]  # [!code highlight]

    # ... ä¸­é—´ä»¶å®ç°çš„å…¶ä½™éƒ¨åˆ†ä¿æŒä¸å˜
```
:::

:::js
```typescript
const skillMiddleware = createMiddleware({  // [!code highlight]
  name: "skillMiddleware",
  stateSchema: CustomStateSchema,  // [!code highlight]
  tools: [loadSkill, writeSqlQuery],  // [!code highlight]
  // ... ä¸­é—´ä»¶å®ç°çš„å…¶ä½™éƒ¨åˆ†ä¿æŒä¸å˜
});
```
:::

ä½¿ç”¨æ³¨å†Œäº†çº¦æŸå·¥å…·çš„ä¸­é—´ä»¶åˆ›å»ºæ™ºèƒ½ä½“ï¼š

:::python
```python
agent = create_agent(
    model,
    system_prompt=(
        "ä½ æ˜¯ä¸€ä¸ª SQL æŸ¥è¯¢åŠ©æ‰‹ï¼Œå¸®åŠ©ç”¨æˆ· "
        "é’ˆå¯¹ä¸šåŠ¡æ•°æ®åº“ç¼–å†™æŸ¥è¯¢ã€‚"
    ),
    middleware=[SkillMiddleware()],  # [!code highlight]
    checkpointer=InMemorySaver(),
)
```
:::

:::js
```typescript
const agent = createAgent({
  model,
  systemPrompt:
    "You are a SQL query assistant that helps users " +
    "write queries against business databases.",
  middleware: [skillMiddleware],  // [!code highlight]
  checkpointer: new MemorySaver(),
});
```
:::

ç°åœ¨ï¼Œå¦‚æœæ™ºèƒ½ä½“åœ¨åŠ è½½æ‰€éœ€æŠ€èƒ½ä¹‹å‰å°è¯•ä½¿ç”¨ `write_sql_query`ï¼Œå®ƒå°†æ”¶åˆ°ä¸€æ¡é”™è¯¯æ¶ˆæ¯ï¼Œæç¤ºå®ƒé¦–å…ˆåŠ è½½é€‚å½“çš„æŠ€èƒ½ï¼ˆä¾‹å¦‚ `sales_analytics` æˆ– `inventory_management`ï¼‰ã€‚è¿™ç¡®ä¿äº†æ™ºèƒ½ä½“åœ¨å°è¯•éªŒè¯æŸ¥è¯¢ä¹‹å‰æ‹¥æœ‰å¿…è¦çš„æ¨¡å¼çŸ¥è¯†ã€‚

</Accordion>

## å®Œæ•´ç¤ºä¾‹

<Accordion title="æŸ¥çœ‹å®Œæ•´å¯è¿è¡Œè„šæœ¬">

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ã€å¯è¿è¡Œçš„å®ç°ï¼Œç»“åˆäº†æœ¬æ•™ç¨‹ä¸­çš„æ‰€æœ‰éƒ¨åˆ†ï¼š

:::python
```python
import uuid
from typing import TypedDict, NotRequired
from langchain.tools import tool
from langchain.agents import create_agent
from langchain.agents.middleware import ModelRequest, ModelResponse, AgentMiddleware
from langchain.messages import SystemMessage
from langgraph.checkpoint.memory import InMemorySaver
from typing import Callable

# Define skill structure
class Skill(TypedDict):
    """A skill that can be progressively disclosed to the agent."""
    name: str
    description: str
    content: str

# Define skills with schemas and business logic
SKILLS: list[Skill] = [
    {
        "name": "sales_analytics",
        "description": "Database schema and business logic for sales data analysis including customers, orders, and revenue.",
        "content": """# Sales Analytics Schema

## Tables

### customers
- customer_id (PRIMARY KEY)
- name
- email
- signup_date
- status (active/inactive)
- customer_tier (bronze/silver/gold/platinum)

### orders
- order_id (PRIMARY KEY)
- customer_id (FOREIGN KEY -> customers)
- order_date
- status (pending/completed/cancelled/refunded)
- total_amount
- sales_region (north/south/east/west)

### order_items
- item_id (PRIMARY KEY)
- order_id (FOREIGN KEY -> orders)
- product_id
- quantity
- unit_price
- discount_percent

## Business Logic

**Active customers**: status = 'active' AND signup_date <= CURRENT_DATE - INTERVAL '90 days'

**Revenue calculation**: Only count orders with status = 'completed'. Use total_amount from orders table, which already accounts for discounts.

**Customer lifetime value (CLV)**: Sum of all completed order amounts for a customer.

**High-value orders**: Orders with total_amount > 1000

## Example Query

-- Get top 10 customers by revenue in the last quarter
SELECT
    c.customer_id,
    c.name,
    c.customer_tier,
    SUM(o.total_amount) as total_revenue
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
WHERE o.status = 'completed'
  AND o.order_date >= CURRENT_DATE - INTERVAL '3 months'
GROUP BY c.customer_id, c.name, c.customer_tier
ORDER BY total_revenue DESC
LIMIT 10;
""",
    },
    {
        "name": "inventory_management",
        "description": "Database schema and business logic for inventory tracking including products, warehouses, and stock levels.",
        "content": """# Inventory Management Schema

## Tables

### products
- product_id (PRIMARY KEY)
- product_name
- sku
- category
- unit_cost
- reorder_point (minimum stock level before reordering)
- discontinued (boolean)

### warehouses
- warehouse_id (PRIMARY KEY)
- warehouse_name
- location
- capacity

### inventory
- inventory_id (PRIMARY KEY)
- product_id (FOREIGN KEY -> products)
- warehouse_id (FOREIGN KEY -> warehouses)
- quantity_on_hand
- last_updated

### stock_movements
- movement_id (PRIMARY KEY)
- product_id (FOREIGN KEY -> products)
- warehouse_id (FOREIGN KEY -> warehouses)
- movement_type (inbound/outbound/transfer/adjustment)
- quantity (positive for inbound, negative for outbound)
- movement_date
- reference_number

## Business Logic

**Available stock**: quantity_on_hand from inventory table where quantity_on_hand > 0

**éœ€è¦è¡¥è´§çš„äº§å“**ï¼šæ‰€æœ‰ä»“åº“ä¸­æ€»åœ¨æ‰‹æ•°é‡ï¼ˆquantity_on_handï¼‰å°äºæˆ–ç­‰äºäº§å“è¡¥è´§ç‚¹ï¼ˆreorder_pointï¼‰çš„äº§å“

**ä»…é™æ´»è·ƒäº§å“**ï¼šæ’é™¤å·²åœäº§ï¼ˆdiscontinued = trueï¼‰çš„äº§å“ï¼Œé™¤éä¸“é—¨åˆ†æå·²åœäº§é¡¹ç›®

**åº“å­˜ä¼°å€¼**ï¼šæ¯ä¸ªäº§å“çš„åœ¨æ‰‹æ•°é‡ï¼ˆquantity_on_handï¼‰ * å•ä½æˆæœ¬ï¼ˆunit_costï¼‰

## ç¤ºä¾‹æŸ¥è¯¢

-- æŸ¥æ‰¾æ‰€æœ‰ä»“åº“ä¸­ä½äºè¡¥è´§ç‚¹çš„äº§å“
SELECT
    p.product_id,
    p.product_name,
    p.reorder_point,
    SUM(i.quantity_on_hand) as total_stock,
    p.unit_cost,
    (p.reorder_point - SUM(i.quantity_on_hand)) as units_to_reorder
FROM products p
JOIN inventory i ON p.product_id = i.product_id
WHERE p.discontinued = false
GROUP BY p.product_id, p.product_name, p.reorder_point, p.unit_cost
HAVING SUM(i.quantity_on_hand) <= p.reorder_point
ORDER BY units_to_reorder DESC;
""",
    },
]

# åˆ›å»ºæŠ€èƒ½åŠ è½½å·¥å…·
@tool
def load_skill(skill_name: str) -> str:
    """å°†æŠ€èƒ½çš„å®Œæ•´å†…å®¹åŠ è½½åˆ°æ™ºèƒ½ä½“ï¼ˆagentï¼‰çš„ä¸Šä¸‹æ–‡ä¸­ã€‚

    å½“ä½ éœ€è¦å…³äºå¦‚ä½•å¤„ç†ç‰¹å®šç±»å‹è¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯æ—¶ä½¿ç”¨æ­¤å·¥å…·ã€‚è¿™å°†ä¸ºä½ æä¾›è¯¥æŠ€èƒ½é¢†åŸŸçš„å…¨é¢è¯´æ˜ã€ç­–ç•¥å’ŒæŒ‡å—ã€‚

    Args:
        skill_name: è¦åŠ è½½çš„æŠ€èƒ½åç§°ï¼ˆä¾‹å¦‚ï¼š"sales_analytics", "inventory_management"ï¼‰
    """
    # æŸ¥æ‰¾å¹¶è¿”å›è¯·æ±‚çš„æŠ€èƒ½
    for skill in SKILLS:
        if skill["name"] == skill_name:
            return f"å·²åŠ è½½æŠ€èƒ½: {skill_name}\n\n{skill['content']}"

    # æœªæ‰¾åˆ°æŠ€èƒ½
    available = ", ".join(s["name"] for s in SKILLS)
    return f"æœªæ‰¾åˆ°æŠ€èƒ½ '{skill_name}'ã€‚å¯ç”¨æŠ€èƒ½: {available}"

# åˆ›å»ºæŠ€èƒ½ä¸­é—´ä»¶
class SkillMiddleware(AgentMiddleware):
    """å°†æŠ€èƒ½æè¿°æ³¨å…¥ç³»ç»Ÿæç¤ºï¼ˆsystem promptï¼‰çš„ä¸­é—´ä»¶ã€‚"""

    # å°† load_skill å·¥å…·æ³¨å†Œä¸ºç±»å˜é‡
    tools = [load_skill]

    def __init__(self):
        """åˆå§‹åŒ–å¹¶ä» SKILLS åˆ—è¡¨ç”ŸæˆæŠ€èƒ½æç¤ºã€‚"""
        # ä» SKILLS åˆ—è¡¨æ„å»ºæŠ€èƒ½æç¤º
        skills_list = []
        for skill in SKILLS:
            skills_list.append(
                f"- **{skill['name']}**: {skill['description']}"
            )
        self.skills_prompt = "\n".join(skills_list)

    def wrap_model_call(
        self,
        request: ModelRequest,
        handler: Callable[[ModelRequest], ModelResponse],
    ) -> ModelResponse:
        """åŒæ­¥ï¼šå°†æŠ€èƒ½æè¿°æ³¨å…¥ç³»ç»Ÿæç¤ºã€‚"""
        # æ„å»ºæŠ€èƒ½é™„åŠ å†…å®¹
        skills_addendum = (
            f"\n\n## å¯ç”¨æŠ€èƒ½\n\n{self.skills_prompt}\n\n"
            "å½“ä½ éœ€è¦å…³äºå¤„ç†ç‰¹å®šç±»å‹è¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯æ—¶ï¼Œè¯·ä½¿ç”¨ load_skill å·¥å…·ã€‚"
        )

        # è¿½åŠ åˆ°ç³»ç»Ÿæ¶ˆæ¯å†…å®¹å—
        new_content = list(request.system_message.content_blocks) + [
            {"type": "text", "text": skills_addendum}
        ]
        new_system_message = SystemMessage(content=new_content)
        modified_request = request.override(system_message=new_system_message)
        return handler(modified_request)

# åˆå§‹åŒ–ä½ çš„èŠå¤©æ¨¡å‹ï¼ˆè¯·æ›¿æ¢ä¸ºä½ çš„æ¨¡å‹ï¼‰
# ç¤ºä¾‹ï¼šfrom langchain_anthropic import ChatAnthropic
# model = ChatAnthropic(model="claude-3-5-sonnet-20241022")
from langchain_openai import ChatOpenAI
model = ChatOpenAI(model="gpt-4")

# åˆ›å»ºæ”¯æŒæŠ€èƒ½çš„æ™ºèƒ½ä½“ï¼ˆagentï¼‰
agent = create_agent(
    model,
    system_prompt=(
        "ä½ æ˜¯ä¸€ä¸ª SQL æŸ¥è¯¢åŠ©æ‰‹ï¼Œå¸®åŠ©ç”¨æˆ·é’ˆå¯¹ä¸šåŠ¡æ•°æ®åº“ç¼–å†™æŸ¥è¯¢ã€‚"
    ),
    middleware=[SkillMiddleware()],
    checkpointer=InMemorySaver(),
)

# ç¤ºä¾‹ç”¨æ³•
if __name__ == "__main__":
    # æ­¤å¯¹è¯çº¿ç¨‹çš„é…ç½®
    thread_id = str(uuid.uuid4())
    config = {"configurable": {"thread_id": thread_id}}

# è¯·æ±‚ SQL æŸ¥è¯¢
    result = agent.invoke(
        {
            "messages": [
                {
                    "role": "user",
                    "content": (
                        "ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼ŒæŸ¥æ‰¾ä¸Šä¸ªæœˆè®¢å•é‡‘é¢è¶…è¿‡ 1000 ç¾å…ƒçš„æ‰€æœ‰å®¢æˆ·"
                    ),
                }
            ]
        },
        config
    )

    # æ‰“å°å¯¹è¯
    for message in result["messages"]:
        if hasattr(message, 'pretty_print'):
            message.pretty_print()
        else:
            print(f"{message.type}: {message.content}")
```
:::

:::js
```typescript
import {
  tool,
  createAgent,
  createMiddleware,
  ToolMessage,
  context,
  type ToolRuntime,
} from "langchain";
import { MemorySaver, Command } from "@langchain/langgraph";
import { ChatOpenAI } from "@langchain/openai";
import { v4 as uuidv4 } from "uuid";
import { z } from "zod";

// ä¸€ä¸ªå¯ä»¥é€æ­¥å‘æ™ºèƒ½ä½“ï¼ˆagentï¼‰æŠ«éœ²çš„æŠ€èƒ½
const SkillSchema = z.object({
  name: z.string(), // æŠ€èƒ½çš„å”¯ä¸€æ ‡è¯†ç¬¦
  description: z.string(), // åœ¨ç³»ç»Ÿæç¤ºä¸­æ˜¾ç¤ºçš„ 1-2 å¥æè¿°
  content: z.string(), // åŒ…å«è¯¦ç»†è¯´æ˜çš„å®Œæ•´æŠ€èƒ½å†…å®¹
});

type Skill = z.infer<typeof SkillSchema>;

const SKILLS: Skill[] = [
  {
    name: "sales_analytics",
    description:
      "ç”¨äºé”€å”®æ•°æ®åˆ†æï¼ˆåŒ…æ‹¬å®¢æˆ·ã€è®¢å•å’Œæ”¶å…¥ï¼‰çš„æ•°æ®åº“æ¨¡å¼å’Œä¸šåŠ¡é€»è¾‘ã€‚",
    content: context`
    # é”€å”®åˆ†ææ¨¡å¼

    ## è¡¨

    ### customers
    - customer_id (ä¸»é”®)
    - name
    - email
    - signup_date
    - status (active/inactive)
    - customer_tier (bronze/silver/gold/platinum)

    ### orders
    - order_id (ä¸»é”®)
    - customer_id (å¤–é”® -> customers)
    - order_date
    - status (pending/completed/cancelled/refunded)
    - total_amount
    - sales_region (north/south/east/west)

    ### order_items
    - item_id (ä¸»é”®)
    - order_id (å¤–é”® -> orders)
    - product_id
    - quantity
    - unit_price
    - discount_percent

    ## ä¸šåŠ¡é€»è¾‘

    **æ´»è·ƒå®¢æˆ·**: status = 'active' AND signup_date <= CURRENT_DATE - INTERVAL '90 days'

    **æ”¶å…¥è®¡ç®—**:
    ä»…ç»Ÿè®¡çŠ¶æ€ä¸º 'completed' çš„è®¢å•ã€‚ä½¿ç”¨ orders è¡¨ä¸­çš„ total_amountï¼Œ
    è¯¥é‡‘é¢å·²è€ƒè™‘æŠ˜æ‰£ã€‚

    **å®¢æˆ·ç»ˆèº«ä»·å€¼ (CLV)**:
    å®¢æˆ·æ‰€æœ‰å·²å®Œæˆè®¢å•é‡‘é¢çš„æ€»å’Œã€‚

    **é«˜ä»·å€¼è®¢å•**:
    total_amount > 1000 çš„è®¢å•

    ## ç¤ºä¾‹æŸ¥è¯¢
    -- è·å–ä¸Šä¸€å­£åº¦æ”¶å…¥æ’åå‰ 10 çš„å®¢æˆ·
    SELECT
        c.customer_id,
        c.name,
        c.customer_tier,
        SUM(o.total_amount) as total_revenue
    FROM customers c
    JOIN orders o ON c.customer_id = o.customer_id
    WHERE o.status = 'completed'
    AND o.order_date >= CURRENT_DATE - INTERVAL '3 months'
    GROUP BY c.customer_id, c.name, c.customer_tier
    ORDER BY total_revenue DESC
    LIMIT 10;`,
  },
  {
    name: "inventory_management",
    description:
      "ç”¨äºåº“å­˜è·Ÿè¸ªï¼ˆåŒ…æ‹¬äº§å“ã€ä»“åº“å’Œåº“å­˜æ°´å¹³ï¼‰çš„æ•°æ®åº“æ¨¡å¼å’Œä¸šåŠ¡é€»è¾‘ã€‚",
    content: context`
    # åº“å­˜ç®¡ç†æ¨¡å¼

    ## è¡¨

    ### products
    - product_id (ä¸»é”®)
    - product_name
    - sku
    - category
    - unit_cost
    - reorder_point (è¡¥è´§å‰çš„æœ€ä½åº“å­˜æ°´å¹³)
    - discontinued (å¸ƒå°”å€¼)

    ### warehouses
    - warehouse_id (ä¸»é”®)
    - warehouse_name
    - location
    - capacity

    ### inventory
    - inventory_id (ä¸»é”®)
    - product_id (å¤–é”® -> products)
    - warehouse_id (å¤–é”® -> warehouses)
    - quantity_on_hand
    - last_updated

### stock_movements
- movement_id (ä¸»é”®)
- product_id (å¤–é”® -> products)
- warehouse_id (å¤–é”® -> warehouses)
- movement_type (å…¥åº“/å‡ºåº“/è°ƒæ‹¨/è°ƒæ•´)
- quantity (å…¥åº“ä¸ºæ­£æ•°ï¼Œå‡ºåº“ä¸ºè´Ÿæ•°)
- movement_date
- reference_number

## ä¸šåŠ¡é€»è¾‘

**å¯ç”¨åº“å­˜**ï¼š
æ¥è‡ª inventory è¡¨çš„ quantity_on_handï¼Œå…¶ä¸­ quantity_on_hand > 0

**éœ€è¦è¡¥è´§çš„äº§å“**ï¼š
æ‰€æœ‰ä»“åº“ä¸­ total quantity_on_hand å°äºæˆ–ç­‰äºäº§å“ reorder_point çš„äº§å“

**ä»…é™æ´»è·ƒäº§å“**ï¼š
æ’é™¤ discontinued = true çš„äº§å“ï¼Œé™¤éä¸“é—¨åˆ†æå·²åœäº§çš„äº§å“

**åº“å­˜ä¼°å€¼**ï¼š
æ¯ä¸ªäº§å“çš„ quantity_on_hand * unit_cost

## ç¤ºä¾‹æŸ¥è¯¢

-- æŸ¥æ‰¾æ‰€æœ‰ä»“åº“ä¸­åº“å­˜ä½äºè¡¥è´§ç‚¹çš„äº§å“
SELECT
    p.product_id,
    p.product_name,
    p.reorder_point,
    SUM(i.quantity_on_hand) as total_stock,
    p.unit_cost,
    (p.reorder_point - SUM(i.quantity_on_hand)) as units_to_reorder
FROM products p
JOIN inventory i ON p.product_id = i.product_id
WHERE p.discontinued = false
GROUP BY p.product_id, p.product_name, p.reorder_point, p.unit_cost
HAVING SUM(i.quantity_on_hand) <= p.reorder_point
ORDER BY units_to_reorder DESC;`,
  },
];

// const loadSkill = tool(
//   async ({ skillName }) => {
//     // æŸ¥æ‰¾å¹¶è¿”å›è¯·æ±‚çš„æŠ€èƒ½
//     const skill = SKILLS.find((s) => s.name === skillName);
//     if (skill) {
//       return `å·²åŠ è½½æŠ€èƒ½: ${skillName}\n\n${skill.content}`;
//     }

//     // æœªæ‰¾åˆ°æŠ€èƒ½
//     const available = SKILLS.map((s) => s.name).join(", ");
//     return `æœªæ‰¾åˆ°æŠ€èƒ½ '${skillName}'ã€‚å¯ç”¨æŠ€èƒ½: ${available}`;
//   },
//   {
//     name: "load_skill",
//     description: `å°†æŠ€èƒ½çš„å®Œæ•´å†…å®¹åŠ è½½åˆ°æ™ºèƒ½ä½“ï¼ˆagentï¼‰çš„ä¸Šä¸‹æ–‡ä¸­ã€‚

// å½“æ‚¨éœ€è¦å…³äºå¦‚ä½•å¤„ç†ç‰¹å®šç±»å‹è¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯æ—¶ä½¿ç”¨æ­¤å·¥å…·ã€‚è¿™å°†ä¸ºæ‚¨æä¾›è¯¥æŠ€èƒ½é¢†åŸŸçš„å…¨é¢è¯´æ˜ã€æ”¿ç­–å’ŒæŒ‡å—ã€‚`,
//     schema: z.object({
//       skillName: z.string().describe("è¦åŠ è½½çš„æŠ€èƒ½åç§°"),
//     }),
//   }
// );

// ä» SKILLS åˆ—è¡¨æ„å»ºæŠ€èƒ½æç¤º
const skillsPrompt = SKILLS.map(
  (skill) => `- **${skill.name}**: ${skill.description}`
).join("\n");

const skillMiddleware = createMiddleware({
  name: "skillMiddleware",
  tools: [loadSkill],
  wrapModelCall: async (request, handler) => {
    // æ„å»ºæŠ€èƒ½é™„åŠ å†…å®¹
    const skillsAddendum =
      `\n\n## å¯ç”¨æŠ€èƒ½\n\n${skillsPrompt}\n\n` +
      "å½“æ‚¨éœ€è¦å…³äºå¦‚ä½•å¤„ç†ç‰¹å®šç±»å‹è¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯æ—¶ï¼Œè¯·ä½¿ç”¨ load_skill å·¥å…·ã€‚" +
      "è¿™å°†ä¸ºæ‚¨æä¾›è¯¥æŠ€èƒ½é¢†åŸŸçš„å…¨é¢è¯´æ˜ã€æ”¿ç­–å’ŒæŒ‡å—ã€‚";

    // é™„åŠ åˆ°ç³»ç»Ÿæç¤º
    const newSystemPrompt = request.systemPrompt + skillsAddendum;

    return handler({
      ...request,
      systemPrompt: newSystemPrompt,
    });
  },
});

const model = new ChatOpenAI({
  model: "gpt-4o-mini",
  temperature: 0,
});

// åˆ›å»ºæ”¯æŒæŠ€èƒ½çš„æ™ºèƒ½ä½“ï¼ˆagentï¼‰
const agent = createAgent({
  model,
  systemPrompt:
    "æ‚¨æ˜¯ä¸€ä¸ª SQL æŸ¥è¯¢åŠ©æ‰‹ï¼Œå¸®åŠ©ç”¨æˆ·é’ˆå¯¹ä¸šåŠ¡æ•°æ®åº“ç¼–å†™æŸ¥è¯¢ã€‚",
  middleware: [skillMiddleware],
  checkpointer: new MemorySaver(),
});

// æ­¤å¯¹è¯çº¿ç¨‹çš„é…ç½®
const threadId = uuidv4();
const config = { configurable: { thread_id: threadId } };

// è¯·æ±‚ä¸€ä¸ª SQL æŸ¥è¯¢
const result = await agent.invoke(
  {
    messages: [
      {
        role: "user",
        content:
          "ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼ŒæŸ¥æ‰¾ä¸Šä¸ªæœˆè®¢å•é‡‘é¢è¶…è¿‡ 1000 ç¾å…ƒçš„æ‰€æœ‰å®¢æˆ·",
      },
    ],
  },
  config
);

// æ‰“å°å¯¹è¯
for (const message of result.messages) {
  console.log(`${message.type}: ${message.content}`);
}
```

è¿™ä¸ªå®Œæ•´ç¤ºä¾‹åŒ…æ‹¬ï¼š
- åŒ…å«å®Œæ•´æ•°æ®åº“æ¨¡å¼çš„æŠ€èƒ½å®šä¹‰
- ç”¨äºæŒ‰éœ€åŠ è½½çš„ `load_skill` å·¥å…·
- å°†æŠ€èƒ½æè¿°æ³¨å…¥ç³»ç»Ÿæç¤ºçš„ `SkillMiddleware`
- å¸¦æœ‰ä¸­é—´ä»¶å’Œæ£€æŸ¥ç‚¹çš„æ™ºèƒ½ä½“åˆ›å»º
- å±•ç¤ºæ™ºèƒ½ä½“å¦‚ä½•åŠ è½½æŠ€èƒ½å’Œç¼–å†™ SQL æŸ¥è¯¢çš„ç¤ºä¾‹ç”¨æ³•

è¦è¿è¡Œæ­¤ç¤ºä¾‹ï¼Œæ‚¨éœ€è¦ï¼š
1. å®‰è£…æ‰€éœ€åŒ…ï¼š`pip install langchain langchain-openai langgraph`
2. è®¾ç½®æ‚¨çš„ API å¯†é’¥ï¼ˆä¾‹å¦‚ï¼š`export OPENAI_API_KEY=...`ï¼‰
3. ç”¨æ‚¨é¦–é€‰çš„ LLM æä¾›å•†æ›¿æ¢æ¨¡å‹åˆå§‹åŒ–

</Accordion>

## å®ç°å˜ä½“

<Accordion title="æŸ¥çœ‹å®ç°é€‰é¡¹å’Œæƒè¡¡">

æœ¬æ•™ç¨‹å°†æŠ€èƒ½å®ç°ä¸ºé€šè¿‡å·¥å…·è°ƒç”¨åŠ è½½çš„å†…å­˜ä¸­ Python å­—å…¸ã€‚ç„¶è€Œï¼Œæœ‰å‡ ç§æ–¹æ³•å¯ä»¥å®ç°æŠ€èƒ½çš„æ¸è¿›å¼æŠ«éœ²ï¼š

**å­˜å‚¨åç«¯ï¼š**
- **å†…å­˜ä¸­**ï¼ˆæœ¬æ•™ç¨‹ï¼‰ï¼šæŠ€èƒ½å®šä¹‰ä¸º Python æ•°æ®ç»“æ„ï¼Œè®¿é—®é€Ÿåº¦å¿«ï¼Œæ—  I/O å¼€é”€
- **æ–‡ä»¶ç³»ç»Ÿ**ï¼ˆClaude Code æ–¹æ³•ï¼‰ï¼šæŠ€èƒ½ä½œä¸ºåŒ…å«æ–‡ä»¶çš„ç›®å½•ï¼Œé€šè¿‡ `read_file` ç­‰æ–‡ä»¶æ“ä½œå‘ç°
- **è¿œç¨‹å­˜å‚¨**ï¼šæŠ€èƒ½å­˜å‚¨åœ¨ S3ã€æ•°æ®åº“ã€Notion æˆ– API ä¸­ï¼ŒæŒ‰éœ€è·å–

**æŠ€èƒ½å‘ç°**ï¼ˆæ™ºèƒ½ä½“å¦‚ä½•äº†è§£å­˜åœ¨å“ªäº›æŠ€èƒ½ï¼‰ï¼š
- **ç³»ç»Ÿæç¤ºåˆ—è¡¨**ï¼šç³»ç»Ÿæç¤ºä¸­åŒ…å«æŠ€èƒ½æè¿°ï¼ˆæœ¬æ•™ç¨‹ä½¿ç”¨ï¼‰
- **åŸºäºæ–‡ä»¶**ï¼šé€šè¿‡æ‰«æç›®å½•å‘ç°æŠ€èƒ½ï¼ˆClaude Code æ–¹æ³•ï¼‰
- **åŸºäºæ³¨å†Œè¡¨**ï¼šæŸ¥è¯¢æŠ€èƒ½æ³¨å†ŒæœåŠ¡æˆ– API ä»¥è·å–å¯ç”¨æŠ€èƒ½
- **åŠ¨æ€æŸ¥æ‰¾**ï¼šé€šè¿‡å·¥å…·è°ƒç”¨åˆ—å‡ºå¯ç”¨æŠ€èƒ½

**æ¸è¿›å¼æŠ«éœ²ç­–ç•¥**ï¼ˆå¦‚ä½•åŠ è½½æŠ€èƒ½å†…å®¹ï¼‰ï¼š
- **å•æ¬¡åŠ è½½**ï¼šé€šè¿‡ä¸€æ¬¡å·¥å…·è°ƒç”¨åŠ è½½æ•´ä¸ªæŠ€èƒ½å†…å®¹ï¼ˆæœ¬æ•™ç¨‹ä½¿ç”¨ï¼‰
- **åˆ†é¡µåŠ è½½**ï¼šå¯¹äºå¤§å‹æŠ€èƒ½ï¼Œåˆ†å¤šä¸ªé¡µé¢/å—åŠ è½½æŠ€èƒ½å†…å®¹
- **åŸºäºæœç´¢**ï¼šåœ¨ç‰¹å®šæŠ€èƒ½å†…å®¹ä¸­æœç´¢ç›¸å…³éƒ¨åˆ†ï¼ˆä¾‹å¦‚ï¼Œå¯¹æŠ€èƒ½æ–‡ä»¶ä½¿ç”¨ grep/read æ“ä½œï¼‰
- **åˆ†å±‚åŠ è½½**ï¼šé¦–å…ˆåŠ è½½æŠ€èƒ½æ¦‚è¿°ï¼Œç„¶åæ·±å…¥ç‰¹å®šå­éƒ¨åˆ†

**å¤§å°è€ƒè™‘**ï¼ˆæœªæ ¡å‡†çš„å¿ƒæ™ºæ¨¡å‹ - è¯·æ ¹æ®æ‚¨çš„ç³»ç»Ÿè¿›è¡Œä¼˜åŒ–ï¼‰ï¼š
- **å°å‹æŠ€èƒ½**ï¼ˆ< 1K ä»¤ç‰Œ / ~750 è¯ï¼‰ï¼šå¯ä»¥ç›´æ¥åŒ…å«åœ¨ç³»ç»Ÿæç¤ºä¸­ï¼Œå¹¶é€šè¿‡æç¤ºç¼“å­˜è¿›è¡Œç¼“å­˜ä»¥èŠ‚çœæˆæœ¬å’ŒåŠ å¿«å“åº”é€Ÿåº¦
- **ä¸­å‹æŠ€èƒ½**ï¼ˆ1-10K ä»¤ç‰Œ / ~750-7.5K è¯ï¼‰ï¼šå—ç›ŠäºæŒ‰éœ€åŠ è½½ä»¥é¿å…ä¸Šä¸‹æ–‡å¼€é”€ï¼ˆæœ¬æ•™ç¨‹ï¼‰
- **å¤§å‹æŠ€èƒ½**ï¼ˆ> 10K ä»¤ç‰Œ / ~7.5K è¯ï¼Œæˆ– > 5-10% çš„ä¸Šä¸‹æ–‡çª—å£ï¼‰ï¼šåº”ä½¿ç”¨åˆ†é¡µã€åŸºäºæœç´¢çš„åŠ è½½æˆ–åˆ†å±‚æ¢ç´¢ç­‰æ¸è¿›å¼æŠ«éœ²æŠ€æœ¯ï¼Œä»¥é¿å…æ¶ˆè€—è¿‡å¤šä¸Šä¸‹æ–‡

é€‰æ‹©å–å†³äºæ‚¨çš„éœ€æ±‚ï¼šå†…å­˜ä¸­æ–¹å¼æœ€å¿«ï¼Œä½†æŠ€èƒ½æ›´æ–°éœ€è¦é‡æ–°éƒ¨ç½²ï¼›è€ŒåŸºäºæ–‡ä»¶æˆ–è¿œç¨‹å­˜å‚¨åˆ™æ— éœ€æ›´æ”¹ä»£ç å³å¯å®ç°åŠ¨æ€æŠ€èƒ½ç®¡ç†ã€‚

</Accordion>

## æ¸è¿›å¼æŠ«éœ²ä¸ä¸Šä¸‹æ–‡å·¥ç¨‹

<Accordion title="ç»“åˆå°‘é‡æ ·æœ¬æç¤ºå’Œå…¶ä»–æŠ€æœ¯">

æ¸è¿›å¼æŠ«éœ²æœ¬è´¨ä¸Šæ˜¯ä¸€ç§ **[ä¸Šä¸‹æ–‡å·¥ç¨‹](/oss/langchain/context-engineering) æŠ€æœ¯** - æ‚¨æ­£åœ¨ç®¡ç†æ™ºèƒ½ä½“ä½•æ—¶å¯ä»¥è·å–å“ªäº›ä¿¡æ¯ã€‚æœ¬æ•™ç¨‹ä¾§é‡äºåŠ è½½æ•°æ®åº“æ¨¡å¼ï¼Œä½†ç›¸åŒçš„åŸåˆ™é€‚ç”¨äºå…¶ä»–ç±»å‹çš„ä¸Šä¸‹æ–‡ã€‚

### ç»“åˆå°‘é‡æ ·æœ¬æç¤º

å¯¹äº SQL æŸ¥è¯¢ç”¨ä¾‹ï¼Œæ‚¨å¯ä»¥æ‰©å±•æ¸è¿›å¼æŠ«éœ²ä»¥åŠ¨æ€åŠ è½½ä¸ç”¨æˆ·æŸ¥è¯¢åŒ¹é…çš„ **å°‘é‡æ ·æœ¬ç¤ºä¾‹**ï¼š

**ç¤ºä¾‹æ–¹æ³•ï¼š**
1. ç”¨æˆ·è¯¢é—®ï¼š"æŸ¥æ‰¾è¿‡å» 6 ä¸ªæœˆæœªä¸‹å•çš„å®¢æˆ·"
2. æ™ºèƒ½ä½“åŠ è½½ `sales_analytics` æ¨¡å¼ï¼ˆå¦‚æœ¬æ•™ç¨‹æ‰€ç¤ºï¼‰
3. æ™ºèƒ½ä½“è¿˜åŠ è½½ 2-3 ä¸ªç›¸å…³ç¤ºä¾‹æŸ¥è¯¢ï¼ˆé€šè¿‡è¯­ä¹‰æœç´¢æˆ–åŸºäºæ ‡ç­¾çš„æŸ¥æ‰¾ï¼‰ï¼š
   - æŸ¥æ‰¾éæ´»è·ƒå®¢æˆ·çš„æŸ¥è¯¢
   - åŸºäºæ—¥æœŸè¿‡æ»¤çš„æŸ¥è¯¢
   - è¿æ¥å®¢æˆ·å’Œè®¢å•è¡¨çš„æŸ¥è¯¢
4. æ™ºèƒ½ä½“ä½¿ç”¨æ¨¡å¼çŸ¥è¯†å’Œç¤ºä¾‹æ¨¡å¼ç¼–å†™æŸ¥è¯¢

è¿™ç§æ¸è¿›å¼æŠ«éœ²ï¼ˆæŒ‰éœ€åŠ è½½æ¨¡å¼ï¼‰ä¸åŠ¨æ€å°‘æ ·æœ¬æç¤ºï¼ˆåŠ è½½ç›¸å…³ç¤ºä¾‹ï¼‰çš„ç»“åˆï¼Œåˆ›é€ äº†ä¸€ç§å¼ºå¤§çš„ä¸Šä¸‹æ–‡å·¥ç¨‹æ¨¡å¼ï¼Œèƒ½å¤Ÿæ‰©å±•åˆ°å¤§å‹çŸ¥è¯†åº“ï¼ŒåŒæ—¶æä¾›é«˜è´¨é‡ã€æœ‰ä¾æ®çš„è¾“å‡ºã€‚

</Accordion>

## åç»­æ­¥éª¤

- äº†è§£[ä¸­é—´ä»¶](/oss/langchain/middleware)ä»¥å®ç°æ›´åŠ¨æ€çš„æ™ºèƒ½ä½“è¡Œä¸º
- æ¢ç´¢[ä¸Šä¸‹æ–‡å·¥ç¨‹](/oss/langchain/context-engineering)æŠ€æœ¯ä»¥ç®¡ç†æ™ºèƒ½ä½“ä¸Šä¸‹æ–‡
- æ¢ç´¢[äº¤æ¥æ¨¡å¼](/oss/langchain/multi-agent/handoffs-customer-support)ä»¥å¤„ç†é¡ºåºå·¥ä½œæµ
- é˜…è¯»[å­æ™ºèƒ½ä½“æ¨¡å¼](/oss/langchain/multi-agent/subagents-personal-assistant)ä»¥äº†è§£å¹¶è¡Œä»»åŠ¡è·¯ç”±
- æŸ¥çœ‹[å¤šæ™ºèƒ½ä½“æ¨¡å¼](/oss/langchain/multi-agent)ä»¥äº†è§£å…¶ä»–ä¸“ç”¨æ™ºèƒ½ä½“æ–¹æ³•
- ä½¿ç”¨[LangSmith](https://smith.langchain.com)æ¥è°ƒè¯•å’Œç›‘æ§æŠ€èƒ½åŠ è½½
