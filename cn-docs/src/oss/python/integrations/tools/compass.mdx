---
title: Compass DeFi å·¥å…·åŒ…
---
ä¸å„ç±» DeFi åè®®äº¤äº’ã€‚éæ‰˜ç®¡å¼ã€‚å·¥å…·è¿”å›*æœªç­¾åäº¤æ˜“*ã€‚è¯¥å·¥å…·åŒ…æ„å»ºåœ¨é€šç”¨ DeFi API ([Compass API](https://api.compasslabs.ai/)) ä¹‹ä¸Šï¼Œå…è®¸ä»£ç†æ‰§è¡Œä»¥ä¸‹é‡‘èæ“ä½œï¼š

- åœ¨ Uniswap å’Œ Aerodrome ä¸Š**å…‘æ¢ä»£å¸**
- ä½¿ç”¨ Aave ä¸Šçš„åè®®è¿›è¡Œèµ„äº§**å€Ÿè´·**
- åœ¨ Aerodrome å’Œ Uniswap ä¸Š**æä¾›æµåŠ¨æ€§**
- åœ¨é’±åŒ…ä¹‹é—´**è½¬ç§»èµ„é‡‘**
- æŸ¥è¯¢ä½™é¢ã€æŠ•èµ„ç»„åˆä»¥åŠ**ç›‘æ§å¤´å¯¸**

## æ¦‚è¿°

### é›†æˆè¯¦æƒ…

| ç±»å                      | åŒ…å               | å¯åºåˆ—åŒ– | JS æ”¯æŒ |                                         ç‰ˆæœ¬                                         |
|:-------------------------|:------------------| :---: | :---: |:-----------------------------------------------------------------------------------:|
| LangchainCompassToolkit  | `langchain-compass` | âŒ | âŒ | ![PyPI - Version](https://img.shields.io/pypi/v/langchain-compass?style=flat-square&label=%20) |

### å·¥å…·ç‰¹æ€§

ä»¥ä¸‹æ˜¯è¯¥å·¥å…·åŒ…æä¾›çš„ä¸€äº›å·¥å…·ç¤ºä¾‹ï¼ˆå¯èƒ½æ¯æ—¥æ›´æ–°ï¼‰ï¼š

- `aave_supply`: å‘ Aave æä¾›èµ„äº§ä»¥èµšå–åˆ©æ¯ã€‚
- `aave_borrow`: ä½¿ç”¨æŠµæŠ¼å“ä» Aave å€Ÿå…¥èµ„äº§ã€‚
- `uniswap_swap_sell_exactly`: åœ¨ Uniswap ä¸Šå…‘æ¢ç‰¹å®šæ•°é‡çš„ä»£å¸ã€‚
- `generic_portfolio_get`: è·å–é’±åŒ…çš„æŠ•èµ„ç»„åˆï¼ˆä»¥ç¾å…ƒè®¡ï¼‰å’Œä»£å¸ä½™é¢ã€‚
- `generic_transfer_erc20`: åœ¨åœ°å€ä¹‹é—´è½¬ç§» ERC20 ä»£å¸ã€‚

## è®¾ç½®

æˆ‘ä»¬å°†åœ¨æ­¤å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š

1. å®‰è£… langchain åŒ…
2. å¯¼å…¥å¹¶å®ä¾‹åŒ–å·¥å…·åŒ…
3. ä½¿ç”¨ `toolkit.get_tools()` å°†å·¥å…·ä¼ é€’ç»™æ‚¨çš„ä»£ç†

### å®‰è£…

æ­¤å·¥å…·åŒ…ä½äº `langchain-compass` åŒ…ä¸­ï¼š

```python
pip install -qU langchain-compass
```

#### ç¯å¢ƒè®¾ç½®

è¦è¿è¡Œè¿™äº›ç¤ºä¾‹ï¼Œè¯·ç¡®ä¿ LangChain å¯ä»¥è®¿é—® LLM æœåŠ¡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨ä½¿ç”¨ GPT-4oï¼Œè¯·åˆ›å»ºä¸€ä¸ªåŒ…å«ä»¥ä¸‹å†…å®¹çš„ `.env` æ–‡ä»¶ï¼š

```plaintext
# .env æ–‡ä»¶
OPENAI_API_KEY=<your_openai_api_key_here>
```

### å®ä¾‹åŒ–

ç°åœ¨æˆ‘ä»¬å¯ä»¥å®ä¾‹åŒ–æˆ‘ä»¬çš„å·¥å…·åŒ…ï¼š

```python
from langchain_compass.toolkits import LangchainCompassToolkit

toolkit = LangchainCompassToolkit(compass_api_key=None)
```

### å·¥å…·

æŸ¥çœ‹[å¯ç”¨å·¥å…·](#tool-features)ï¼š

```python
tools = toolkit.get_tools()
for tool in tools:
    print(tool.name)
```

```
# é¢„æœŸè¾“å‡ºï¼š

aave_supply
aave_borrow
aave_repay
aave_withdraw
aave_asset_price_get
aave_liquidity_change_get
aave_user_position_summary_get
...
```

## è°ƒç”¨

è¦ä»¥ç¼–ç¨‹æ–¹å¼è°ƒç”¨å•ä¸ªå·¥å…·ï¼š

```python
tool_name = "generic_ens_get"
tool = next(tool for tool in tools if tool.name == tool_name)
tool.invoke({"ens_name": "vitalik.eth", "chain": "ethereum:mainnet"})
```

```text
EnsNameInfoResponse(wallet_address='0xd8dA6BF26964aF9D7eEd9e03E53415D37aA96045', registrant='0xd8dA6BF26964aF9D7eEd9e03E53415D37aA96045')
```

## åœ¨ä»£ç†ä¸­ä½¿ç”¨

æˆ‘ä»¬éœ€è¦ä¸€ä¸ª LLM æˆ–èŠå¤©æ¨¡å‹ï¼š

```python
from dotenv import load_dotenv
from langchain_openai import ChatOpenAI

load_dotenv()

llm = ChatOpenAI(model="gpt-4o")
```

ä½¿ç”¨å·¥å…·åˆå§‹åŒ–ä»£ç†ï¼š

```python
from langchain.agents import create_agent


tools = toolkit.get_tools()
agent_executor = create_agent(llm, tools)
```

ä½¿ç”¨ç¤ºä¾‹ï¼š

```python
example_query = "please set an allowance on Uniswap of 10 WETH for vitalic.eth."  # æ•…æ„æ‹¼å†™é”™è¯¯

events = agent_executor.stream(
    {"messages": [("user", example_query)]},
    stream_mode="values",
)
for event in events:
    event["messages"][-1].pretty_print()
```

é¢„æœŸè¾“å‡ºï¼š

```
================================[1m Human Message [0m=================================

please set an allowance on Uniswap of 10 WETH for vitalic.eth.
==================================[1m Ai Message [0m==================================
Tool Calls:
  generic_ens_get (call_MHIXRXxWH0L7iUEYHwvDUdU1)
 Call ID: call_MHIXRXxWH0L7iUEYHwvDUdU1
  Args:
    chain: ethereum:mainnet
    ens_name: vitalic.eth
=================================[1m Tool Message [0m=================================
Name: generic_ens_get

wallet_address='0x44761Ef63FaD902D8f8dC77e559Ab116929881Db' registrant='0x44761Ef63FaD902D8f8dC77e559Ab116929881Db'
==================================[1m Ai Message [0m==================================
Tool Calls:
  generic_allowance_set (call_IEBftbtBfKCkI1zFXXtEY8tq)
 Call ID: call_IEBftbtBfKCkI1zFXXtEY8tq
  Args:
    amount: 10
    chain: ethereum:mainnet
    contract_name: UniswapV3Router
    sender: 0x44761Ef63FaD902D8f8dC77e559Ab116929881Db
    token: WETH
=================================[1m Tool Message [0m=================================
Name: generic_allowance_set

{"type": "unsigned_transaction", "content": {"chainId": 1, "data": "0x095ea7b300000000000000000000000068b3465833fb72a70ecdf485e0e4c7bd8665fc450000000000000000000000000000000000000000000000008ac7230489e80000", "from": "0x44761Ef63FaD902D8f8dC77e559Ab116929881Db", "gas": 46434, "to": "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2", "value": 0, "nonce": 79, "maxFeePerGas": 2265376912, "maxPriorityFeePerGas": 6400594}}
```

---

## API å‚è€ƒ

`langchain-compass` æ„å»ºåœ¨ Compass API ä¹‹ä¸Šã€‚æ¯ä¸ªå·¥å…·å¯¹åº”ä¸€ä¸ª API ç«¯ç‚¹ã€‚[è¯·åœ¨æ­¤å¤„æŸ¥çœ‹æ–‡æ¡£](https://api.compasslabs.ai/)
