---
title: Google Drive
---
本笔记本将指导您如何将 LangChain 连接到 `Google Drive API`。

## 先决条件

1. 创建一个 Google Cloud 项目或使用现有项目
2. 启用 [Google Drive API](https://console.cloud.google.com/flows/enableapi?apiid=drive.googleapis.com)
3. [为桌面应用程序授权凭据](https://developers.google.com/drive/api/quickstart/python#authorize_credentials_for_a_desktop_application)
4. `pip install -U google-api-python-client google-auth-httplib2 google-auth-oauthlib`

## 检索 Google Docs 数据的说明

默认情况下，`GoogleDriveTools` 和 `GoogleDriveWrapper` 期望 `credentials.json` 文件位于 `~/.credentials/credentials.json`，但您可以通过设置 `GOOGLE_ACCOUNT_FILE` 环境变量为您的 `custom/path/to/credentials.json` 来配置此路径。
`token.json` 的位置使用同一目录（或使用参数 `token_path`）。请注意，`token.json` 将在您首次使用该工具时自动创建。

`GoogleDriveSearchTool` 可以通过一些请求检索选定的文件。

默认情况下，如果您使用 `folder_id`，则此文件夹内所有名称匹配查询的文件都可以被检索为 `Document`。

```python
pip install -qU  google-api-python-client google-auth-httplib2 google-auth-oauthlib langchain-community
```

您可以从 URL 获取您的文件夹和文档 ID：

* 文件夹：[drive.google.com/drive/u/0/folders/1yucgL9WGgWZdM1TOuKkeghlPizuzMYb5](https://drive.google.com/drive/u/0/folders/1yucgL9WGgWZdM1TOuKkeghlPizuzMYb5) -> 文件夹 ID 为 `"1yucgL9WGgWZdM1TOuKkeghlPizuzMYb5"`
* 文档：[docs.google.com/document/d/1bfaMQ18_i56204VaQDVeAFpqEijJTgvurupdEDiaUQw/edit](https://docs.google.com/document/d/1bfaMQ18_i56204VaQDVeAFpqEijJTgvurupdEDiaUQw/edit) -> 文档 ID 为 `"1bfaMQ18_i56204VaQDVeAFpqEijJTgvurupdEDiaUQw"`

特殊值 `root` 代表您的个人主目录。

```python
folder_id = "root"
# folder_id='1yucgL9WGgWZdM1TOuKkeghlPizuzMYb5'
```

默认情况下，具有以下 MIME 类型的所有文件都可以转换为 `Document`。
* text/text
* text/plain
* text/html
* text/csv
* text/markdown
* image/png
* image/jpeg
* application/epub+zip
* application/pdf
* application/rtf
* application/vnd.google-apps.document (GDoc)
* application/vnd.google-apps.presentation (GSlide)
* application/vnd.google-apps.spreadsheet (GSheet)
* application/vnd.google.colaboratory (Notebook colab)
* application/vnd.openxmlformats-officedocument.presentationml.presentation (PPTX)
* application/vnd.openxmlformats-officedocument.wordprocessingml.document (DOCX)

可以更新或自定义此列表。请参阅 `GoogleDriveAPIWrapper` 的文档。

但是，必须安装相应的包。

```python
pip install -qU  unstructured langchain-googledrive
```

```python
import os

from langchain_googledrive.tools.google_drive.tool import GoogleDriveSearchTool
from langchain_googledrive.utilities.google_drive import GoogleDriveAPIWrapper

os.environ["GOOGLE_ACCOUNT_FILE"] = "custom/path/to/credentials.json"

# 默认情况下，仅在文件名中搜索。
tool = GoogleDriveSearchTool(
    api_wrapper=GoogleDriveAPIWrapper(
        folder_id=folder_id,
        num_results=2,
        template="gdrive-query-in-folder",  # 在文档正文中搜索
    )
)
```

```python
import logging

logging.basicConfig(level=logging.INFO)
```

```python
tool.run("machine learning")
```

```python
tool.description
```

```text
"A wrapper around Google Drive Search. Useful for when you need to find a document in google drive. The input should be formatted as a list of entities separated with a space. As an example, a list of keywords is 'hello word'."
```

## 在 ReAct 智能体中使用该工具

为了创建一个使用 Google Jobs 工具的智能体，请安装 LangGraph

```python
pip install -qU langgraph langchain-openai
```

并使用 @[`create_agent`] 功能来初始化一个 ReAct 智能体。您还需要设置您的 OPEN_API_KEY（访问 [platform.openai.com](https://platform.openai.com)）以便访问 OpenAI 的聊天模型。

```python
import os

from langchain.chat_models import init_chat_model
from langchain.agents import create_agent


os.environ["OPENAI_API_KEY"] = "your-openai-api-key"


model = init_chat_model("gpt-4o-mini", model_provider="openai", temperature=0)
agent = create_agent(model, tools=[tool])

events = agent.stream(
    {"messages": [("user", "Search in google drive, who is 'Yann LeCun' ?")]},
    stream_mode="values",
)
for event in events:
    event["messages"][-1].pretty_print()
```
