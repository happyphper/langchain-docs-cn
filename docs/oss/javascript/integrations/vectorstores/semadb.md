---
title: SemaDB
---
> [SemaDB](https://www.semafind.com/products/semadb) 来自 [SemaFind](https://www.semafind.com)，是一个用于构建 AI 应用程序的、简单易用的向量相似性数据库。托管的 `SemaDB Cloud` 提供了无负担的开发者体验，让您轻松上手。

完整的 API 文档、示例以及交互式演示平台可在 [RapidAPI](https://rapidapi.com/semafind-semadb/api/semadb) 上找到。

本笔记本演示了如何使用 `SemaDB Cloud` 向量存储。

您需要安装 `langchain-community`，使用 `pip install -qU langchain-community` 来使用此集成。

## 加载文档嵌入

为了在本地运行，我们使用常用于句子嵌入的 [Sentence Transformers](https://www.sbert.net/)。您可以使用 LangChain 提供的任何嵌入模型。

```python
pip install -qU  sentence_transformers
```

```python
from langchain_huggingface import HuggingFaceEmbeddings

model_name = "sentence-transformers/all-mpnet-base-v2"
embeddings = HuggingFaceEmbeddings(model_name=model_name)
```

```python
from langchain_community.document_loaders import TextLoader
from langchain_text_splitters import CharacterTextSplitter

loader = TextLoader("../../how_to/state_of_the_union.txt")
documents = loader.load()
text_splitter = CharacterTextSplitter(chunk_size=400, chunk_overlap=0)
docs = text_splitter.split_documents(documents)
print(len(docs))
```

```text
114
```

## 连接到 SemaDB

SemaDB Cloud 使用 [RapidAPI 密钥](https://rapidapi.com/semafind-semadb/api/semadb) 进行身份验证。您可以通过创建免费的 RapidAPI 账户来获取您的密钥。

```python
import getpass
import os

if "SEMADB_API_KEY" not in os.environ:
    os.environ["SEMADB_API_KEY"] = getpass.getpass("SemaDB API Key:")
```

```text
SemaDB API Key: ········
```

```python
from langchain_community.vectorstores import SemaDB
from langchain_community.vectorstores.utils import DistanceStrategy
```

SemaDB 向量存储的参数直接反映了 API：

- "mycollection": 是我们要存储这些向量的集合名称。
- 768: 是向量的维度。在我们的例子中，句子转换器嵌入产生 768 维向量。
- API_KEY: 是您的 RapidAPI 密钥。
- embeddings: 对应于文档、文本和查询的嵌入将如何生成。
- DistanceStrategy: 是使用的距离度量。如果使用 COSINE，包装器会自动对向量进行归一化。

```python
db = SemaDB("mycollection", 768, embeddings, DistanceStrategy.COSINE)

# 如果是第一次运行，则创建集合。如果集合
# 已存在，此操作将失败。
db.create_collection()
```

```text
True
```

SemaDB 向量存储包装器将文档文本作为点元数据添加，以便稍后收集。*不建议*存储大块的文本。如果您正在索引一个大型集合，我们建议改为存储对文档的引用，例如外部 ID。

```python
db.add_documents(docs)[:2]
```

```python
['813c7ef3-9797-466b-8afa-587115592c6c',
 'fc392f7f-082b-4932-bfcc-06800db5e017']
```

## 相似性搜索

我们使用默认的 LangChain 相似性搜索接口来搜索最相似的句子。

```python
query = "What did the president say about Ketanji Brown Jackson"
docs = db.similarity_search(query)
print(docs[0].page_content)
```

```text
And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation’s top legal minds, who will continue Justice Breyer’s legacy of excellence.
```

```python
docs = db.similarity_search_with_score(query)
docs[0]
```

```text
(Document(page_content='And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation’s top legal minds, who will continue Justice Breyer’s legacy of excellence.', metadata={'source': '../../how_to/state_of_the_union.txt', 'text': 'And I did that 4 days ago, when I nominated Circuit Court of Appeals Judge Ketanji Brown Jackson. One of our nation’s top legal minds, who will continue Justice Breyer’s legacy of excellence.'}),
 0.42369342)
```

## 清理

您可以删除集合以移除所有数据。

```python
db.delete_collection()
```

```text
True
```

```python

```
