---
title: 开放代理规范
---
本页面涵盖了 LangChain 与 [Open Agent Specification](https://oracle.github.io/agent-spec) 的所有集成。

Open Agent Spec 是 Oracle 提供的一个与框架无关的声明式语言，用于定义智能体系统。它允许以可移植的 JSON/YAML 格式定义智能体和工作流，这些配置可以在不同的运行时环境中执行。

## 安装与设置

您可以参考 [安装指南](https://oracle.github.io/agent-spec/installation.html) 来安装 `pyagentspec`。

随后，您可以通过其额外依赖项安装 LangGraph 适配器：

```bash
pip install "pyagentspec[langgraph]"
```

## LangGraph 适配器
**LangGraph 适配器** 允许使用 LangGraph 来实例化和执行 Open Agent Spec 配置。
`AgentSpecLoader` 类负责加载 Agent Spec 配置（JSON 或 YAML 格式），并在 LangGraph 环境中将它们实例化为可运行的智能体。它还支持将声明的工具映射到相应的 Python 函数。

以下示例展示了如何创建一个简单的 Agent Spec 智能体并将其转换为 LangGraph 助手。
从创建 Agent Spec 智能体开始：

```python
# 创建一个 Agent Spec 智能体
from pyagentspec.agent import Agent
from pyagentspec.llms.openaicompatibleconfig import OpenAiCompatibleConfig
from pyagentspec.property import FloatProperty
from pyagentspec.tools import ServerTool

subtraction_tool = ServerTool(
    name="subtraction-tool",
    description="subtract two numbers together",
    inputs=[FloatProperty(title="a"), FloatProperty(title="b")],
    outputs=[FloatProperty(title="difference")],
)

agentspec_llm_config = OpenAiCompatibleConfig(
    name="llama-3.3-70b-instruct",
    model_id="/storage/models/Llama-3.3-70B-Instruct",
    url="url.to.my.llm",
)

agentspec_agent = Agent(
    name="agentspec_tools_test",
    description="agentspec_tools_test",
    llm_config=agentspec_llm_config,
    system_prompt="Perform subtraction with the given tool.",
    tools=[subtraction_tool],
)
```

随后可以将该智能体导出为 JSON：

```python
# 导出 Agent Spec 配置
from pyagentspec.serialization import AgentSpecSerializer

agentspec_config = AgentSpecSerializer().to_json(agentspec_agent)
```

并使用 `AgentSpecLoader` 将其转换为 LangGraph 助手。
该示例还展示了工具的映射和对话的执行。

```python
# 使用 LangGraph 加载并运行 Agent Spec 配置
from pyagentspec.adapters.langgraph import AgentSpecLoader

def subtract(a: float, b: float) -> float:
    return a - b

async def main():
    loader = AgentSpecLoader(tool_registry={"subtraction-tool": subtract})
    assistant = loader.load_json(agentspec_config)

    while True:
        user_input = input("USER >> ")
        if user_input == "exit":
            break
        result = await assistant.ainvoke(
            input={"messages": [{"role": "user", "content": user_input}]},
        )
        print(f"AGENT >> {result['messages'][-1].content}")
```
